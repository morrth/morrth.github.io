<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>springboot内置https</title>
      <link href="2021/041812222.html"/>
      <url>2021/041812222.html</url>
      
        <content type="html"><![CDATA[<h2 id="Spring-Boot中启用HTTPS"><a href="#Spring-Boot中启用HTTPS" class="headerlink" title="Spring Boot中启用HTTPS"></a>Spring Boot中启用HTTPS</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><strong>出于HTTPS的安全策略，浏览器一般会阻断HTTPS上的非安全请求（HTTP）请求</strong></p><p>因为项目是HTTPS页面所以发送不了HTTP请求，需要在后端Spring Boot中启用HTTPS，以发送https请求</p><h3 id="启用https"><a href="#启用https" class="headerlink" title="启用https"></a>启用https</h3><p>默认情况下Spring Boot内嵌的Tomcat服务器会在8080端口启动HTTP服务，Spring Boot允许在application.properties或application.yml配置文件设置HTTP或HTTPS，但是不可同时配置，如果两个都启动，至少有一个要以编程的方式配置，SpringBoot官方文档建议在配置文件中配置HTTPS，因为HTTPS比HTTP更复杂一些</p><p>在配置文件中配置HTTPS，配置信息如下：</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">server:  ssl:  #证书的路径    key-store: classpath:*******.jks    #证书密码，请修改为您自己证书的密码.    key-password: ******    #秘钥库类型    key-store-type: JKS    enabled: true  port: 8181<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注意：请将证书放到src/main/resources目录下，也就是证书文件中Tomcat文件下的jks后缀文件，另一个txt文件为存放密码。</p><p>发送请求时：https://<strong>证书对应的ip地址或域名</strong>:8181/******</p><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a><strong>小结</strong></h3><p>在spring boot中要使用https的话，那么重要的就是几个步骤：</p><p>（1）需要准备SSL证书</p><p>（2）在配置文件中配置HTTPS信息</p>]]></content>
      
      
      <categories>
          
          <category> springboot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http </tag>
            
            <tag> https </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vuex防止页面刷新丢失数据</title>
      <link href="2021/041312222.html"/>
      <url>2021/041312222.html</url>
      
        <content type="html"><![CDATA[<h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>在vue项目运行中，通常刷新页面后，vuex数据会丢失，这是因为vuex数据是存储在运行内存中，当页面刷新时，会重新加载vue实例，vuex数据也会重新初始化</p><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><h3 id="使用webstorage对vuex数据进行缓存"><a href="#使用webstorage对vuex数据进行缓存" class="headerlink" title="使用webstorage对vuex数据进行缓存"></a>使用<strong>webstorage</strong>对vuex数据进行缓存</h3><p>因为vue实例重新加载，app.vue也会重新加载，所以可在app.vue的生命周期函数中对数据进行缓存和提取</p><p>localStorage – 是永久存储在本地，除非你主动去删除<br>sessionStorage – 是存储到当前页面关闭为止</p><p>此处采用sessionStorage 进行缓存</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"store"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">replaceState</span><span class="token punctuation">(</span>        Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"store"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">//在页面刷新时将vuex里的信息保存到sessionStorage里</span>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"beforeunload"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>      sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"store"</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="也可以使用vuex-persistedstate插件来保存-保存在localstorage"><a href="#也可以使用vuex-persistedstate插件来保存-保存在localstorage" class="headerlink" title="也可以使用vuex-persistedstate插件来保存(保存在localstorage)"></a>也可以使用vuex-persistedstate插件来保存(保存在localstorage)</h3><p>vuex-persistedstate可以帮助我们持久化vuex</p><p>安装下载</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install vuex<span class="token operator">-</span>persistedstate <span class="token operator">--</span>save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>用vuex中的plugins属性挂载</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'vuex'</span><span class="token keyword">import</span> createPersistedState <span class="token keyword">from</span> <span class="token string">'vuex-persistedstate'</span>Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>   <span class="token comment">//...放 state,mutations,getters数据的地方</span>       plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">createPersistedState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后在我们的localstorage中就会看到有一个vuex的key，并且每次我们更新vuex的状态，localstorage中的vuex也会随之改变</p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Failed to mount component template or render function not defined.</title>
      <link href="2021/040818005.html"/>
      <url>2021/040818005.html</url>
      
        <content type="html"><![CDATA[<h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><p>Failed to mount component: template or render function not defined.<br>项目可以正常启动，但是浏览器 f12 却报错，查看发现并没有缺少包什么的</p><h2 id="排查"><a href="#排查" class="headerlink" title="排查"></a>排查</h2><p>通过排查代码发现，是在引入vue文件导致的，因为本人在开发过程中，将js文件单独拆分出来了，导致同一个文件夹中存在index.vue和index.js的后缀不同的同名文件引入文件时省略了后缀名，导致产生歧义<br><strong>因此，补全引入文件的后缀即可</strong></p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 坑 </tag>
            
            <tag> 错误处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jvm初探</title>
      <link href="2021/040117221.html"/>
      <url>2021/040117221.html</url>
      
        <content type="html"><![CDATA[<h1 id="JVM初探"><a href="#JVM初探" class="headerlink" title="JVM初探"></a>JVM初探</h1><h2 id="1、JVM的位置"><a href="#1、JVM的位置" class="headerlink" title="1、JVM的位置"></a>1、JVM的位置</h2><p><img src="/assets/image-20210129163223110.png" alt="image-20210129163223110"></p><h2 id="2、JVM体系结构"><a href="#2、JVM体系结构" class="headerlink" title="2、JVM体系结构"></a>2、JVM体系结构</h2><p><img src="/assets/image-20210131113845513.png" alt="image-20210131113845513"></p><blockquote><p>本地方法接口：JNI（Java Native Interface）</p></blockquote><h2 id="3、类加载器"><a href="#3、类加载器" class="headerlink" title="3、类加载器"></a>3、类加载器</h2><blockquote><p>作用：加载Class文件。</p></blockquote><p><img src="/assets/image-20210129173753042.png" alt="image-20210129173753042"></p><ul><li>1、虚拟机自带的加载器</li><li>2、启动类（根）加载器【BOOT】</li><li>3、扩展类加载器【EXT】</li><li>4、应用程序加载器【APP】</li></ul><p><strong>注：从4到1进行加载</strong></p><h3 id="1、双亲委派"><a href="#1、双亲委派" class="headerlink" title="1、双亲委派"></a>1、双亲委派</h3><p>**解释：双亲委派机制（安全）：APP—&gt;EXT—&gt;BOOT【最终执行】 **</p><ol><li>类加载器收到类加载的请求</li><li>将这个请求向上委托为父类加载器去完成，一直向上委托，直到启动类加载器</li><li>启动类加载器检查是否能够加载当前的这个类，能加载就结束，使用当前的加载器，否则抛出异常，通知子加载器进行加载</li><li>重复步骤 3</li></ol><blockquote><p>但是BOOT根加载器输出是null，这是java调用不到~   C，C++</p><p>Java = C++– ：去掉繁琐的东西（指针、内存管理等）</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.parents;/** * 双亲委派机制 */public class Car {    public static void main(String[] args) {        Car car1 = new Car();        Car car2 = new Car();        Car car3 = new Car();        //不同的实例        System.out.println("car1 hashCode="+car1.hashCode());        System.out.println("car2 hashCode="+car2.hashCode());        System.out.println("car3 hashCode="+car3.hashCode());        //同一个类模版        Class&lt;? extends Car&gt; aClass1 = car1.getClass();        Class&lt;? extends Car&gt; aClass2 = car2.getClass();        Class&lt;? extends Car&gt; aClass3 = car3.getClass();        System.out.println("aClass1 hashCode="+aClass1.hashCode());        System.out.println("aClass2 hashCode="+aClass2.hashCode());        System.out.println("aClass3 hashCode="+aClass3.hashCode());        //由于类模版都是一个，以下就选择一个进行测试        ClassLoader classLoader = aClass1.getClassLoader();        System.out.println(classLoader);  //AppClassLoader        System.out.println(classLoader.getParent());  //ExtClassLoader  所在位置：\jre\lib\ext        System.out.println(classLoader.getParent().getParent());  //null 1.不存在  2.java程序获取不到  所在位置：rt.jar    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>运行测试结果：</li></ul><p><img src="/assets/image-20210129185753713.png" alt="image-20210129185753713"></p><h3 id="2、面试问题"><a href="#2、面试问题" class="headerlink" title="2、面试问题"></a>2、面试问题</h3><ul><li><p>为什么需要双亲委派机制?（也就是双亲委派的优点）</p><p>①双亲委派机制使得类加载出现层级，父类加载器加载过的类，子类加载器不会重复加载，可以<strong>防止类重复加载</strong>；</p><p>②使得类的加载出现优先级，<strong>防止了核心API被篡改</strong>，提升了安全，所以越基础的类就会越上层进行加载，反而一般自己的写的类，就会在应用程序加载器（Application）直接加载。</p></li><li><p>如何打破双亲委派？</p><p>①自定义类加载器，重写loadClass方法</p><p>②使用线程上下文类加载器</p></li></ul><h2 id="4、沙箱安全机制"><a href="#4、沙箱安全机制" class="headerlink" title="4、沙箱安全机制"></a>4、沙箱安全机制</h2><h3 id="1、什么是沙箱"><a href="#1、什么是沙箱" class="headerlink" title="1、什么是沙箱"></a>1、什么是沙箱</h3><p>​        沙箱是一个限制程序运行的环境。沙箱机制就是将 Java 代码限定在虚拟机(JVM)特定的运行范围中，并且严格限制代码对本地系统资源访问，通过这样的措施来保证对代码的有效隔离，防止对本地系统造成破坏。沙箱<strong>主要限制系统资源访问</strong>，那系统资源包括什么？——==CPU、内存、文件系统、网络==。不同级别的沙箱对这些资源访问的限制也可以不一样。</p><p>​        所有的Java程序运行都可以指定沙箱，可以定制安全策略。</p><h3 id="2、组成沙箱的基本组件"><a href="#2、组成沙箱的基本组件" class="headerlink" title="2、组成沙箱的基本组件"></a>2、组成沙箱的基本组件</h3><ul><li><code>字节码校验器</code>（bytecode verifier）：确保Java类文件遵循Java语言规范。这样可以帮助Java程序实现内存保护。但并不是所有的类文件都会经过字节码校验，比如核心类。</li><li><code>类装载器</code>（class loader）：其中类装载器在3个方面对Java沙箱起作用   <ul><li>它防止恶意代码去干涉善意的代码；</li><li>它守护了被信任的类库边界；</li><li>它将代码归入保护域，确定了代码可以进行哪些操作。</li></ul></li></ul><p>  虚拟机为不同的类加载器载入的类提供不同的命名空间，命名空间由一系列唯一的名称组成，每一个被装载的类将有一个名字，这个命名空间是由Java虚拟机为每一个类装载器维护的，它们互相之间甚至不可见。</p><p>  <strong>类装载器采用的机制是==双亲委派模式==。</strong></p><ol><li>从最内层JVM自带类加载器开始加载，外层恶意同名类得不到加载从而无法使用；</li><li>由于严格通过包来区分了访问域，外层恶意的类通过内置代码也无法获得权限访问到内层类，破坏代码就自然无法生效。</li></ol><ul><li><code>存取控制器</code>（access controller）：存取控制器可以控制核心API对操作系统的存取权限，而这个控制的策略设定，可以由用户指定。</li><li><code>安全管理器</code>（security manager）：是核心API和操作系统之间的主要接口。实现权限控制，比存取控制器优先级高。</li><li><code>安全软件包</code>（security package）：java.security下的类和扩展包下的类，允许用户为自己的应用增加新的安全特性，包括：   <ul><li>安全提供者</li><li>消息摘要</li><li>数字签名</li><li>加密</li><li>鉴别</li></ul></li></ul><h2 id="5、Native"><a href="#5、Native" class="headerlink" title="5、Native"></a>5、Native</h2><p>编写一个多线程启动类</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">public static void main(String[] args) {    new Thread(() -&gt; {},"Thread1").start();}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>点进去start方法</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">public synchronized void start() {    if (threadStatus != 0)        throw new IllegalThreadStateException();    group.add(this);    boolean started = false;    try {        start0(); // 调用了start0()方法        started = true;    } finally {        try {            if (!started) {                group.threadStartFailed(this);            }        } catch (Throwable ignore) {        }    }}// 凡是带了native关键字的，就说明Java的作用范围达不到了，会去调用底层C语言的库private native void start0(); //start0()方法的定义，这个方法会调用底层C<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>Java在内存区域中专门开辟了一块标记区域——本地方法栈，用来登记native方法，凡是带了native关键字的，会进入到本地方法栈中，调用本地方法接口（JNI），在最终执行的时候，加载本地方法库中的方法通过JNI</p></blockquote><p><img src="/assets/image-20210131125351239.png" alt="image-20210131125351239"></p><ul><li>JNI的作用：扩展Java的使用，融合不同的编程语言为Java所用，不过最初是想融合C，C++的，因为Java诞生的时候，C，C++横行，想要立足的话就要有能调用C的程序</li><li>本地方法栈：具体做法是，在Native Method Stack中登记native方法，在执行引擎执行的时候加载Native Libraies【本地库】</li></ul><h2 id="6、PC寄存器"><a href="#6、PC寄存器" class="headerlink" title="6、PC寄存器"></a>6、PC寄存器</h2><p>程序计数器：Program Counter Register</p><p>​        每个线程都有一个程序计数器， 是线程私有的，就是一个指针， 指向方法区中的方法字节码(用来存储指向像一条指令的地址， 也即将要执行的指令代码)，在执行引擎读取下一条指令, 是一个非常小的内存空间，几乎可以忽略不计</p><h2 id="7、方法区"><a href="#7、方法区" class="headerlink" title="7、方法区"></a>7、方法区</h2><p>方法区：Method Area</p><p>​        方法区是被所有线程共享，所有字段和方法字节码，以及一些特殊方法，如构造函数，接口代码也在此定义，简单说，所有定义的方法的信息都保存在该区域，<strong>此区域属于共享区间</strong>；</p><p>​        静态变量、常量、类信息(构造方法、接口定义)、运行时的常量池存在方法区中，但是实例变量存在堆内存中，和方法区无关。简单的来说就是：==static、final、Class、常量池==</p><h2 id="8、栈"><a href="#8、栈" class="headerlink" title="8、栈"></a>8、栈</h2><ul><li><p>程序 = 数据结构 + 算法 【持续学习】</p></li><li><p>大多数人程序 = 框架 + 业务逻辑【饭碗】</p></li></ul><blockquote><p>栈：先进后出，后进先出</p><p>队列：先进先出（FIFO：first input first output）</p></blockquote><p>栈：栈内存，主管程序的运行，生命周期和线程同步；</p><p>线程结束，栈内存也就释放了，对于栈来说==不存在垃圾回收问题==，一旦线程结束，栈就Over了</p><h3 id="1、栈里面存放什么"><a href="#1、栈里面存放什么" class="headerlink" title="1、栈里面存放什么"></a>1、栈里面存放什么</h3><p>栈：8大基本类型 + 对象的引用 + 实例的方法</p><h3 id="2、栈运行原理"><a href="#2、栈运行原理" class="headerlink" title="2、栈运行原理"></a>2、栈运行原理</h3><p>栈帧</p><p><img src="/assets/image-20210201182918164.png" alt="image-20210201182918164"></p><p>栈满了：StackOverflowError</p><h3 id="3、栈堆方法区的交互关系"><a href="#3、栈堆方法区的交互关系" class="headerlink" title="3、栈堆方法区的交互关系"></a>3、栈堆方法区的交互关系</h3><p><img src="/assets/image-20210201185248813.png" alt="image-20210201185248813"></p><h2 id="9、三种JVM"><a href="#9、三种JVM" class="headerlink" title="9、三种JVM"></a>9、三种JVM</h2><ul><li>Sun公司 HotSpot <code>Java HotSpot(TM) 64-Bit Server VM (build 25.121-b13, mixed mode)</code></li><li>BEA <code>JRockit</code></li><li>IBM <code>J9VM</code></li></ul><h2 id="10、堆"><a href="#10、堆" class="headerlink" title="10、堆"></a>10、堆</h2><blockquote><p>Heap，一个JVM只有一个堆内存，堆内存的大小是可以调节的。</p></blockquote><h3 id="1、堆里面存放什么"><a href="#1、堆里面存放什么" class="headerlink" title="1、堆里面存放什么"></a>1、堆里面存放什么</h3><p>类加载器读取了类文件后，一般会把什么东西放在堆中？ <em>类，方法，常量，变量，保存我们所有引用类型的真实对象</em></p><p>堆内存中还要细分为三个区域：</p><ul><li>新生区（伊甸园区）young/new</li><li>养老区 old</li><li>永久区 perm</li></ul><p>==GC垃圾回收，主要在<strong>伊甸园区</strong>和<strong>养老区</strong>==</p><p><img src="/assets/image-20210201210010927.png" alt="image-20210201210010927"></p><p>假设内存满了，OOM，堆内存不够！<code>java.lang.OutOfMemoryError: Java heap space</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.heapOverflow;import java.util.Random;/** * 堆溢出 */public class HeapOver {    public static void main(String[] args) {        String name = "adfjkllkjfdsa";        while(true){            name += name + new Random().nextInt(888888888)+new Random().nextInt(999999999);        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/assets/image-20210201212708979.png" alt="image-20210201212708979">在JDK8以后，永久存储区改了个名字叫：==元空间==</p><h3 id="2、新生区"><a href="#2、新生区" class="headerlink" title="2、新生区"></a>2、新生区</h3><ul><li>新生区：类诞生和成长的地方，甚至死亡；<ul><li>伊甸园区，所有对象都是在伊甸园区new出来的</li><li>幸存者区（0、1）</li></ul></li></ul><p><img src="/assets/image-20210201215342076.png" alt="image-20210201215342076"></p><p>真理：进过研究，99%的对象都是临时对象！</p><h3 id="3、养老区"><a href="#3、养老区" class="headerlink" title="3、养老区"></a>3、养老区</h3><p>新生区没干掉，没杀死的来到了养老区~</p><h3 id="4、永久区"><a href="#4、永久区" class="headerlink" title="4、永久区"></a>4、永久区</h3><p>这个区域是常驻内存的。用来存放JDK自身携带的Class对象，Interface元数据，存储的是Java运行时的一些环境或类信息，这个区域不存在垃圾回收！当关闭VM虚拟机就会释放这个区域的内存。</p><p>一个启动类加载了大量的第三方jar包；Tomcat部署了太多的应用；大量动态生成的反射类等 不断的被加载，直到内存满，就会出现OOM。</p><ul><li>jdk1.6 之前：永久代，常量池是在方法区中；</li><li>jdk1.7         ：永久代，但是慢慢退化了，<code>去永久代</code>，常量池在堆中</li><li>jdk1.8 之后：无永久代，常量池在元空间</li></ul><p><img src="/assets/image-20210201222307209.png" alt="image-20210201222307209"></p><blockquote><p>但是，元空间：逻辑上存在，物理上不存在</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.heapOverflow;/** * 元空间逻辑上存在，物理上不存在 */public class SanQu {    public static void main(String[] args) {        // 返回jvm试图使用的最大内存        long max = Runtime.getRuntime().maxMemory();        // 返回jvm的初始化内存        long total = Runtime.getRuntime().totalMemory();        System.out.println("max="+max+"字节\t"+(max/(1024*1024))+"MB");        System.out.println("total="+total+"字节\t"+(total/(1024*1024))+"MB");        //默认情况下，试图分配的最大内存是电脑内存的1/4，而初始化的内存是1/64        // -Xms1024m -Xmx1024m -XX:+PrintGCDetails    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><p><img src="/assets/image-20210201230739376.png" alt="image-20210201230739376"></p><p>当修改了VM选项后：<code>-Xms1024m -Xmx1024m -XX:+PrintGCDetails</code>，输出结果：</p><p><img src="/assets/image-20210201230953431.png" alt="image-20210201230953431"></p><p>让我们来算一笔账，</p><p>新生区：305664k；养老区：699392k</p><p>加在一起：1,005,056k，除以1024后 = 981.5MB，等于jvm试图分配的最大内存，所以说元空间逻辑上存在，物理上不存在。</p><h3 id="5、出现OOM"><a href="#5、出现OOM" class="headerlink" title="5、出现OOM"></a>5、出现OOM</h3><ol><li><p>尝试扩大堆内存去查看内存结果</p><p><code>-Xms1024m -Xmx1024m -XX:+PrintGCDetails</code></p></li><li><p>若不行，分析内存，看一下是哪个地方出现了问题（专业工具）</p><ul><li>能够看到代码第几行出错：内存快照分析工具，MAT（eclipse），Jprofiler</li><li>Dubug，一行行分析代码！（不现实）</li></ul></li></ol><p>MAT，Jprofiler作用：</p><ul><li>分析Dump内存文件，快速定位内存泄漏</li><li>获得堆中的数据</li><li>获得大的对象</li><li>……</li></ul><p>运行出现堆溢出：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.heapOverflow;import java.util.ArrayList;public class JprofilerTest {    byte[] array = new byte[1*1024*1024];    public static void main(String[] args) {        ArrayList&lt;JprofilerTest&gt; list = new ArrayList&lt;&gt;();        int count = 0;        try {            while(true){                list.add(new JprofilerTest());                count++;            }        }catch (Exception e){            System.out.println("count="+count);            e.printStackTrace();        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>设置VM options <code>-Xms1m -Xmx8m -XX:+HeapDumpOnOutOfMemoryError</code>后，再次运行，控制台输出：</p><p><img src="/assets/image-20210202134131995.png" alt="image-20210202134131995"></p><p>找到HPROF快照</p><p><img src="/assets/image-20210202140158342.png" alt="image-20210202140158342"></p><p>双击打开</p><p><img src="/assets/image-20210202140606282.png" alt="image-20210202140606282"></p><p>修改代码，把try catch中的Exception改成Error后运行：</p><p><img src="/assets/image-20210202172145431.png" alt="image-20210202172145431"></p><h3 id="6、VM-options参数"><a href="#6、VM-options参数" class="headerlink" title="6、VM options参数"></a>6、VM options参数</h3><p>-Xms    设置初始化内存分配大小，默认1/64</p><p>-Xmx    设置最大分配内存，默认1/4</p><p>-XX:+PrintGCDetails    打印GC垃圾回收信息</p><p>-XX:+HeapDumpOnOutOfMemoryError    生成oomDump文件</p><p><code>-Xms1m -Xmx8m -XX:+HeapDumpOnOutOfMemoryError</code></p><p><code>-Xms1024m -Xmx1024m -XX:+PrintGCDetails</code></p><h2 id="11、GC垃圾回收"><a href="#11、GC垃圾回收" class="headerlink" title="11、GC垃圾回收"></a>11、GC垃圾回收</h2><h3 id="1、GC的作用区域"><a href="#1、GC的作用区域" class="headerlink" title="1、GC的作用区域"></a>1、GC的作用区域</h3><p><img src="/assets/image-20210202173224815.png" alt="image-20210202173224815"></p><p>JVM在进行GC时，并不是对这三个区域统一回收，大部分时候，回收都是新生代</p><ul><li>新生代</li><li>幸存区（form to）【会交换的，不是一成不变的】</li><li>老年区</li></ul><p>GC两种类型：轻GC（普通的GC），重GC（全局GC）</p><h3 id="2、GC相关题目"><a href="#2、GC相关题目" class="headerlink" title="2、GC相关题目"></a>2、GC相关题目</h3><ul><li>JVM的内存模型和分区~详细到每个区放什么？</li><li>堆里面的分区有哪些？Eden，from，to，old，说说他们的特点~</li><li>GC的算法有哪些？标记清除法，标记整理/压缩法，复制算法，引用计数法，怎么用的？</li><li>轻GC和重GC分别在什么时候发生？</li></ul><h3 id="3、GC算法"><a href="#3、GC算法" class="headerlink" title="3、GC算法"></a>3、GC算法</h3><h4 id="引用计数法"><a href="#引用计数法" class="headerlink" title="引用计数法"></a>引用计数法</h4><p><img src="/assets/image-20210202191444745.png" alt="image-20210202191444745"></p><blockquote><p>哪个对象的引用数为0，就会回收哪个对象</p></blockquote><h4 id="复制算法"><a href="#复制算法" class="headerlink" title="复制算法"></a>复制算法</h4><p><img src="/assets/image-20210202200613995.png" alt="image-20210202200613995"></p><blockquote><p>一般新生代（伊甸园区、幸存区）会使用复制算法，生成新的to区</p></blockquote><ul><li>好处：没有内存的碎片</li><li>坏处：浪费了内存空间，多了一半空间永远是空to</li></ul><p>==复制算法最佳使用场景：对象存活度较低的时候，也就是新生区==</p><h4 id="标记清除"><a href="#标记清除" class="headerlink" title="标记清除"></a>标记清除</h4><p><img src="/assets/image-20210202203154896.png" alt="image-20210202203154896"></p><ul><li>缺点：两次扫描，严重浪费时间，会产生内存碎片</li><li>优点：不需要额外的空间</li></ul><h4 id="标记压缩"><a href="#标记压缩" class="headerlink" title="标记压缩"></a>标记压缩</h4><p>对于标记清除的再压缩</p><p><img src="/assets/image-20210202204042836.png" alt="image-20210202204042836"></p><p>但是又多了一个移动成本</p><h4 id="标记清除压缩"><a href="#标记清除压缩" class="headerlink" title="标记清除压缩"></a>标记清除压缩</h4><p>先标记清除一次，然后再压缩</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>内存效率：复制算法 &gt; 标记清除算法 &gt; 标记压缩算法（时间复杂度）</p><p>内存整齐度：复制算法 = 标记压缩算法 &gt; 标记清除算法</p><p>内存利用率：标记压缩算法 = 标记清除算法 &gt; 复制算法</p><p>思考：难道没有最优算法吗？</p><p>答案：没有，没有最好的算法，只有最合适的——&gt;GC：分代收集算法</p><p><strong>年轻代：</strong></p><ul><li>存活率低</li><li>复制算法</li></ul><p><strong>老年代：</strong></p><ul><li>区域大，存活率高</li><li>标记清除（内存碎片不是太多） + 标记压缩混合实现</li></ul><h1 id="JMM"><a href="#JMM" class="headerlink" title="JMM"></a>JMM</h1><ol><li><p>什么是JMM？</p><p>JMM：Java Memory Model的缩写</p></li><li><p>它干嘛的？</p><p>作用：缓存一致性协议，用于定义数据读写的规则。</p><p>JMM定义了线程工作内存和主内存之间的抽象关系，线程之间的共享内存存储在主内存（Main Memory）中，每个线程都有一个私有的本地内存（Local Memory）</p></li></ol><p><img src="/assets/image-20210202211809212.png" alt="image-20210202211809212"></p><p>解决共享对象可见性这个问题：voliate</p><ol start="3"><li><p>它该如何学习？</p><p>JMM：抽象的概念，理论</p><p>voliate等等</p></li></ol><p>最后：==拥抱开源时代，享受技术给我们带来的新体验==</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
          <category> jvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java 多线程</title>
      <link href="2021/040117000.html"/>
      <url>2021/040117000.html</url>
      
        <content type="html"><![CDATA[<h2 id="1、创建线程的两种方法"><a href="#1、创建线程的两种方法" class="headerlink" title="1、创建线程的两种方法"></a>1、创建线程的两种方法</h2><h3 id="1、继承Thread类"><a href="#1、继承Thread类" class="headerlink" title="1、继承Thread类"></a>1、继承Thread类</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.demo01;/** * 创建线程方式1，继承Thread */public class ThreadTest extends Thread{    @Override    public void run() {        for (int i=0;i&lt;20;i++){            System.out.println("子线程启动"+i);        }    }    public static void main(String[] args) {        ThreadTest threadTest = new ThreadTest();        threadTest.start();        for (int i = 0; i &lt; 200; i++) {            System.out.println("主线程启动"+i);        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2、实现Runnable接口"><a href="#2、实现Runnable接口" class="headerlink" title="2、实现Runnable接口"></a>2、实现Runnable接口</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.demo01;/** * 创建线程方式2，实现Runnable接口 */public class ThreadTest2 implements Runnable {    @Override    public void run() {        for (int i=0;i&lt;20;i++){            System.out.println("子线程启动"+i);        }    }    public static void main(String[] args) {        ThreadTest2 threadTest2 = new ThreadTest2();        new Thread(threadTest2).start();        for (int i = 0; i &lt; 200; i++) {            System.out.println("主线程启动"+i);        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>推荐使用第二种，实现Runnable接口。</p></blockquote><blockquote><p>还有第三种Callable接口</p></blockquote><h3 id="3、下载网络图片"><a href="#3、下载网络图片" class="headerlink" title="3、下载网络图片"></a>3、下载网络图片</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.demo01;import org.apache.commons.io.FileUtils;import java.io.File;import java.io.IOException;import java.net.URL;public class Downloader implements Runnable {    private String url;    private String name;    public Downloader(String url, String name) {        this.url = url;        this.name = name;    }    @Override    public void run() {        WebDownloader webDownloader = new WebDownloader();        try {            webDownloader.downloader(url,name);            System.out.println("下载了文件名："+name);        } catch (IOException e) {            e.printStackTrace();        }    }    public static void main(String[] args) {        Downloader d1 = new Downloader("https://i0.hdslb.com/bfs/sycp/creative_img/202012/625fd761428be531b5405815ea33768b.jpg","第一个.jpg");        Downloader d2 = new Downloader("https://i0.hdslb.com/bfs/sycp/creative_img/202102/d521778b3f50444d90e6fefc6719065c.jpg","第二个.jpg");        Downloader d3 = new Downloader("https://i0.hdslb.com/bfs/activity-plat/static/20200714/953d0bfef678072bd11ec5fb6ff04190/nMOp2aGOf.png@400w_413h_1c_100q.webp","第三个.jpg");        new Thread(d1).start();        new Thread(d2).start();        new Thread(d3).start();    }}class WebDownloader{    public void downloader(String url,String name) throws IOException {        FileUtils.copyURLToFile(new URL(url),new File(name));    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4、小结"><a href="#4、小结" class="headerlink" title="4、小结"></a>4、小结</h3><ul><li>继承Thread类<ul><li>子类继承Thread类具有多线程能力</li><li>启动线程：子类对象.start()</li><li>==不建议使用，避免OOP单继承局限性==</li></ul></li><li>实现Runnable接口<ul><li>实现接口Runnable具有多线程能力</li><li>启动线程：传入目标对象+Thread对象.start()</li><li>==推荐使用，避免单继承局限性，灵活方便，方便同一个对象被多个线程使用==</li></ul></li></ul><h2 id="2、静态代理"><a href="#2、静态代理" class="headerlink" title="2、静态代理"></a>2、静态代理</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.proxystatic;/** * 静态代理 */public class Test {    public static void main(String[] args) {        You you = new You();        WeddingCompany weddingCompany = new WeddingCompany(you);        weddingCompany.marry();    }}interface Marry{    void marry();}//真实对象：结婚的人class You implements Marry{    @Override    public void marry() {        System.out.println("小明准备结婚了！");    }}//代理对象：婚庆公司class WeddingCompany implements Marry{    private You you;    public WeddingCompany(You you) {        this.you = you;    }    @Override    public void marry() {        before();        you.marry();        after();    }    private void after() {        System.out.println("婚庆公司在结婚之后，收钱~");    }    private void before() {        System.out.println("婚庆公司在结婚之前，准备布置~");    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3、lambda"><a href="#3、lambda" class="headerlink" title="3、lambda"></a>3、lambda</h2><h3 id="1、逐渐演进的版本"><a href="#1、逐渐演进的版本" class="headerlink" title="1、逐渐演进的版本"></a>1、逐渐演进的版本</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.lambda;public class TestLambda1 {    //3.静态内部类    static class Like2 implements ILike{        @Override        public void like() {            System.out.println("lambda like 2");        }    }    public static void main(String[] args) {        ILike like = new Like();        like.like();        like = new Like2();        like.like();        //4.局部内部类        class Like3 implements ILike{            @Override            public void like() {                System.out.println("lambda like 3");            }        }        like = new Like3();        like.like();        //5.匿名内部类        like = new ILike() {            @Override            public void like() {                System.out.println("lambda like 4");            }        };        like.like();        //6.lambda表达式        like = ()-&gt;{System.out.println("lambda like 5");};        like.like();    }}//1.定义一个函数式接口interface ILike{    void like();}//2.实现类class Like implements ILike{    @Override    public void like() {        System.out.println("lambda like 1");    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2、最终简化版"><a href="#2、最终简化版" class="headerlink" title="2、最终简化版"></a>2、最终简化版</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.lambda;public class TestLambda2 {    public static void main(String[] args) {        ILove love = null;        love = (a,name)-&gt;{            System.out.println("a="+a);            System.out.println("名字="+name);        };        love.love(12,"王菲");    }}interface ILove{    void love(int a,String name);}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3、总结"><a href="#3、总结" class="headerlink" title="3、总结"></a>3、总结</h3><ul><li>lambda表达式只能有一行代码的情况下，才能简化为一行，如果有多行，那么就用代码块包裹</li><li>前提接口是函数式接口，只有一个方法的接口</li><li>多个参数也可以去掉参数，要去掉就都去掉，而且必须加上括号</li></ul><h3 id="4、线程状态"><a href="#4、线程状态" class="headerlink" title="4、线程状态"></a>4、线程状态</h3><p><img src="/assets/image-20210204111058577.png" alt="image-20210204111058577"></p><p>详细</p><p><img src="/assets/image-20210204112126116.png" alt="image-20210204112126116"></p><h2 id="4、线程控制"><a href="#4、线程控制" class="headerlink" title="4、线程控制"></a>4、线程控制</h2><h3 id="1、停止stop"><a href="#1、停止stop" class="headerlink" title="1、停止stop"></a>1、停止stop</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.staticThread;/** * 1、建议线程正常停止，利用次数，不建议死循环 * 2、建议使用标志位，设置一个标志位 * 3、不要使用stop或者destroy等过时或者JDK不建议使用的方法 */public class TestStop implements Runnable{    private boolean flag = true;    @Override    public void run() {        int i = 0;        while (flag){            System.out.println("run....Runnable Thread "+i++);        }    }    public void over(){        flag = false;    }    public static void main(String[] args) {        TestStop testStop = new TestStop();        new Thread(testStop).start();        for (int i = 0; i &lt; 1000; i++) {            System.out.println("test main "+i);            if(i==500){                testStop.over();                System.out.println("线程停止了");            }        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2、睡眠sleep"><a href="#2、睡眠sleep" class="headerlink" title="2、睡眠sleep"></a>2、睡眠sleep</h3><p>模拟网络延时</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.staticThread;/** * 模拟网络延时，放大问题的发生性 */public class TestSleep implements Runnable {    private int tickteNum = 10;    @Override    public void run() {        while (true){            if(tickteNum&lt;=0){                break;            }else {                //模拟延时                try {                    Thread.sleep(100);                } catch (InterruptedException e) {                    e.printStackTrace();                }                System.out.println(Thread.currentThread().getName()+"得到了第 "+tickteNum--+" 票");            }        }    }    public static void main(String[] args) {        TestSleep testSleep = new TestSleep();        new Thread(testSleep,"小红").start();        new Thread(testSleep,"小明").start();        new Thread(testSleep,"小黄").start();    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>倒计时，输出当前时间</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.staticThread;import java.text.SimpleDateFormat;import java.util.Date;/** * 模拟倒计时，获取当前系统时间 */public class TestSleep2 {    public static void main(String[] args) throws InterruptedException {        TestSleep2 testSleep2 = new TestSleep2();        //testSleep2.tenDown();        testSleep2.getTime();    }    public void tenDown() throws InterruptedException {        int i = 10;        while (true){            if(i&lt;=0){                break;            }else{                Thread.sleep(1000);                System.out.println(i--);            }        }    }    public void getTime() throws InterruptedException {        Date startTime = new Date(System.currentTimeMillis());//获取当前系统时间        while (true){            Thread.sleep(1000);            System.out.println(new SimpleDateFormat("HH:mm:ss").format(startTime));            startTime = new Date(System.currentTimeMillis());//跟新当前时间        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>内个对象都有一把锁，sleep不会释放锁~</p></blockquote><h3 id="3、礼让yield"><a href="#3、礼让yield" class="headerlink" title="3、礼让yield"></a>3、礼让yield</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.staticThread;public class TestYield {    public static void main(String[] args) {        MyYield myYield = new MyYield();        new Thread(myYield,"小红").start();        new Thread(myYield,"小名").start();    }}class MyYield implements Runnable{    @Override    public void run() {        System.out.println(Thread.currentThread().getName()+"线程在执行");        Thread.yield();        System.out.println(Thread.currentThread().getName()+"线程被暂停");    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>礼让不一定成功，要看CPU的心情~</p><p>礼让线程，让当前正在执行的线程暂停，但不阻塞，将线程从运行状态转为就绪状态</p></blockquote><h3 id="4、合并Join"><a href="#4、合并Join" class="headerlink" title="4、合并Join"></a>4、合并Join</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.staticThread;public class TestJoin implements Runnable{    @Override    public void run() {        for (int i = 0; i &lt; 1000; i++) {            System.out.println("线程VIP来了"+i);        }    }    public static void main(String[] args) throws InterruptedException {        TestJoin testJoin = new TestJoin();        Thread thread = new Thread(testJoin);        thread.start();        for (int i = 0; i &lt; 500; i++) {            if(i==200){                //插队                thread.join();            }            System.out.println("main "+i);        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>也就是插队，待此线程执行完成后，再执行其他的线程，其他线程阻塞</p></blockquote><h3 id="5、线程的状态"><a href="#5、线程的状态" class="headerlink" title="5、线程的状态"></a>5、线程的状态</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.staticThread;/** * 观察线程的状态 */public class TestState {    public static void main(String[] args) throws InterruptedException {        //使线程睡眠5秒        Thread thread = new Thread(()-&gt;{            for (int i = 0; i &lt; 5; i++) {                try {                    Thread.sleep(1000);                } catch (InterruptedException e) {                    e.printStackTrace();                }            }        });        //观察状态        Thread.State state = thread.getState();        System.out.println(state);//NEW        thread.start();        state = thread.getState();        System.out.println(state);//RUNNABLE        while (state!=Thread.State.TERMINATED){            state = thread.getState();            Thread.sleep(100);            System.out.println(state);//TERMINATED        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>当线程TERMINATED后（死亡后），就不能启动了，所以线程只能启动一次</p></blockquote><h3 id="6、线程的优先级"><a href="#6、线程的优先级" class="headerlink" title="6、线程的优先级"></a>6、线程的优先级</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.priority;public class TestPriority {    public static void main(String[] args) {        System.out.println(Thread.currentThread().getName()+"--&gt;"+Thread.currentThread().getPriority());        MyPriority myPriority = new MyPriority();        Thread t1 = new Thread(myPriority);        Thread t2 = new Thread(myPriority);        Thread t3 = new Thread(myPriority);        Thread t4 = new Thread(myPriority);        Thread t5 = new Thread(myPriority);        t1.setPriority(10);        t1.start();        t2.setPriority(5);        t2.start();        t3.setPriority(1);        t3.start();        t4.setPriority(8);        t4.start();        t5.setPriority(3);        t5.start();    }}class MyPriority implements Runnable{    @Override    public void run() {        System.out.println(Thread.currentThread().getName()+"--&gt;"+Thread.currentThread().getPriority());    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>先设置优先级，再启动</p><p>优先级低的只是意味着获得CPU调度的概率低，并不是优先级底就不会被调用了</p></blockquote><h3 id="7、守护（daemon）线程"><a href="#7、守护（daemon）线程" class="headerlink" title="7、守护（daemon）线程"></a>7、守护（daemon）线程</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.daemon;/** * 测试守护线程 */public class TestDaemon {    public static void main(String[] args) {        God god = new God();        You you = new You();        Thread thread = new Thread(god);        thread.setDaemon(true);//变成守护线程，默认是false        thread.start();        new Thread(you).start();    }}class God implements Runnable{    @Override    public void run() {        while (true){            System.out.println("上帝保佑着你");        }    }}class You implements Runnable{    @Override    public void run() {        for (int i = 0; i &lt; 365; i++) {            System.out.println("-----开心的活着-----");        }        System.out.println("---goodBye world---");    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>线程分为==用户线程==和==守护线程==</p><ul><li>虚拟机必须等到==用户线程==执行完毕【例如：main等】</li><li>虚拟机不用等到==守护线程==执行完毕【例如：GC等】</li></ul></blockquote><h2 id="5、线程同步"><a href="#5、线程同步" class="headerlink" title="5、线程同步"></a>5、线程同步</h2><h3 id="1、三大线程不安全案例"><a href="#1、三大线程不安全案例" class="headerlink" title="1、三大线程不安全案例"></a>1、三大线程不安全案例</h3><p>不安全的买票</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.syn;/** * 不安全的买票 */public class UnSafeBuyTicket {    public static void main(String[] args) {        BuyTicket buyTicket = new BuyTicket();        new Thread(buyTicket,"小明").start();        new Thread(buyTicket,"小红").start();        new Thread(buyTicket,"黄牛党").start();    }}class BuyTicket implements Runnable{    private int ticketNums = 10;    boolean flag = true;    @Override    public void run() {        //买票        while (flag){            buy();        }    }    public void buy(){        if (ticketNums&lt;=0){            flag = false;            return;        }        try {            Thread.sleep(100);        } catch (InterruptedException e) {            e.printStackTrace();        }        System.out.println(Thread.currentThread().getName()+"--&gt;"+ticketNums--);    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>不安全的取钱</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.syn;public class UnSafeBank {    public static void main(String[] args) {        Account account = new Account(100,"理财基金");        TakeMoney you = new TakeMoney(account,50,"你");        TakeMoney girlFriend = new TakeMoney(account,100,"女朋友");        you.start();        girlFriend.start();    }}//账户class Account{    int money;//余额    String name;//卡名    public Account(int money, String name) {        this.money = money;        this.name = name;    }}//模拟取钱class TakeMoney extends Thread{    Account account;    int takeMoney;    int nowMoney;    public TakeMoney(Account account, int takeMoney, String name) {        super(name);        this.account = account;        this.takeMoney = takeMoney;    }    @Override    public void run() {        //判断有没有钱        if(account.money-this.takeMoney&lt;0){            System.out.println("账户余额不足~，还剩 "+account.money);            return;        }        try {            Thread.sleep(1000);        } catch (InterruptedException e) {            e.printStackTrace();        }        account.money = account.money - takeMoney;        nowMoney = nowMoney + takeMoney;        System.out.println(account.name+"--&gt;"+"账户余额："+account.money);        System.out.println(this.getName()+"--&gt;"+"手里钱："+nowMoney);    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>不安全的集合</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.syn;import java.util.ArrayList;/** * 不安全的集合 */public class UnSafeList {    public static void main(String[] args) throws InterruptedException {        ArrayList&lt;String&gt; list = new ArrayList&lt;&gt;();        for (int i = 0; i &lt; 10000; i++) {            new Thread(()-&gt;{                list.add(Thread.currentThread().getName());            }).start();        }        Thread.sleep(10);        System.out.println("list's size = "+list.size());    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2、synchronize同步"><a href="#2、synchronize同步" class="headerlink" title="2、synchronize同步"></a>2、synchronize同步</h3><p>对于上述三种线程不安全的案例解决方案</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.syn;/** * 不安全的买票 */public class UnSafeBuyTicket {    public static void main(String[] args) {        BuyTicket buyTicket = new BuyTicket();        new Thread(buyTicket,"小明").start();        new Thread(buyTicket,"小红").start();        new Thread(buyTicket,"黄牛党").start();    }}class BuyTicket implements Runnable{    private int ticketNums = 10;    boolean flag = true;    @Override    public void run() {        //买票        while (flag){            try {                Thread.sleep(100);            } catch (InterruptedException e) {                e.printStackTrace();            }            buy();        }    }    //synchronized，同步方法，锁的是this    public synchronized void buy(){        if (ticketNums&lt;=0){            flag = false;            return;        }        System.out.println(Thread.currentThread().getName()+"--&gt;"+ticketNums--);    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.syn;public class UnSafeBank {    public static void main(String[] args) {        Account account = new Account(100,"理财基金");        TakeMoney you = new TakeMoney(account,50,"你");        TakeMoney girlFriend = new TakeMoney(account,100,"女朋友");        you.start();        girlFriend.start();    }}//账户class Account{    int money;//余额    String name;//卡名    public Account(int money, String name) {        this.money = money;        this.name = name;    }}//模拟取钱class TakeMoney extends Thread{    Account account;    int takeMoney;    int nowMoney;    public TakeMoney(Account account, int takeMoney, String name) {        super(name);        this.account = account;        this.takeMoney = takeMoney;    }    @Override    public void run() {        //锁住account，因为account在增加减少【锁住变化的量】        synchronized(account){            //判断有没有钱            if(account.money-this.takeMoney&lt;0){                System.out.println("账户余额不足~，还剩 "+account.money);                return;            }            try {                Thread.sleep(1000);            } catch (InterruptedException e) {                e.printStackTrace();            }            account.money = account.money - takeMoney;            nowMoney = nowMoney + takeMoney;            System.out.println(account.name+"--&gt;"+"账户余额："+account.money);            System.out.println(this.getName()+"--&gt;"+"手里钱："+nowMoney);        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.syn;import java.util.ArrayList;/** * 不安全的集合 */public class UnSafeList {    public static void main(String[] args) throws InterruptedException {        ArrayList&lt;String&gt; list = new ArrayList&lt;&gt;();        for (int i = 0; i &lt; 10000; i++) {            new Thread(()-&gt;{                synchronized (list){                    list.add(Thread.currentThread().getName());                }            }).start();        }        Thread.sleep(10);        System.out.println("list's size = "+list.size());    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>记住：对于synchronized的对象就是我们需要==修改的对象==即可</p></blockquote><h2 id="6、锁"><a href="#6、锁" class="headerlink" title="6、锁"></a>6、锁</h2><h3 id="1、死锁"><a href="#1、死锁" class="headerlink" title="1、死锁"></a>1、死锁</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.lock;public class DeadLock {    public static void main(String[] args) {        Makeup g1 = new Makeup(0,"小红");        Makeup g2 = new Makeup(1,"小明明");        g1.start();        g2.start();    }}class LipStick{}class Mirror{}class Makeup extends Thread{    //需要一份资源，用static来保证只有一份资源    static LipStick lipStick = new LipStick();    static Mirror mirror = new Mirror();    private int choice;    private String girlName;    public Makeup(int choice,String girlName){        this.choice = choice;        this.girlName = girlName;    }    @Override    public void run() {        makeup();    }    private void makeup() {        if(choice==0){            //不要同时抱一把锁就好了            synchronized (lipStick){                System.out.println(this.girlName+"获得口红");//                synchronized (mirror){//                    System.out.println(this.girlName+"获得镜子");//                }            }            synchronized (mirror){                System.out.println(this.girlName+"获得镜子");            }        }else{            synchronized (mirror){                System.out.println(this.girlName+"获得镜子");//                synchronized (lipStick){//                    System.out.println(this.girlName+"获得口红");//                }            }            synchronized (lipStick){                System.out.println(this.girlName+"获得口红");            }        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2、死锁产生的必要条件"><a href="#2、死锁产生的必要条件" class="headerlink" title="2、死锁产生的必要条件"></a>2、死锁产生的必要条件</h3><p><img src="/assets/image-20210204214449140.png" alt="image-20210204214449140"></p><h3 id="3、ReentrantLock可重入锁"><a href="#3、ReentrantLock可重入锁" class="headerlink" title="3、ReentrantLock可重入锁"></a>3、ReentrantLock可重入锁</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.lock;import java.util.concurrent.locks.ReentrantLock;public class TestReentrantLock {    public static void main(String[] args) {        Lock2 lock2 = new Lock2();        new Thread(lock2).start();        new Thread(lock2).start();    }}class Lock2 implements Runnable{    private int ticketNums = 10;    private final ReentrantLock reentrantLock = new ReentrantLock();    @Override    public void run() {        while (true){            try{                //加锁                reentrantLock.lock();                if(ticketNums&lt;=0){                    break;                }else{                    try {                        Thread.sleep(1000);                    } catch (InterruptedException e) {                        e.printStackTrace();                    }                    System.out.println(ticketNums--);                }            }            finally {                //解锁                reentrantLock.unlock();            }        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/assets/image-20210204220748282.png" alt="image-20210204220748282"></p><h2 id="7、线程通信"><a href="#7、线程通信" class="headerlink" title="7、线程通信"></a>7、线程通信</h2><h3 id="1、管程法"><a href="#1、管程法" class="headerlink" title="1、管程法"></a>1、管程法</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package com.draco.gaoji;/** * */public class TestPC {    public static void main(String[] args) {        KeepSpace keepSpace = new KeepSpace();        new Thread(new Producer(keepSpace)).start();        new Thread(new Customer(keepSpace)).start();    }}class Food{    int id;    public Food(int id) {        this.id = id;    }}class Producer implements Runnable{    KeepSpace keepSpace;    public Producer(KeepSpace keepSpace) {        this.keepSpace = keepSpace;    }    @Override    public void run() {        for (int i = 0; i &lt; 100; i++) {            keepSpace.push(new Food(i));            System.out.println("生产了第"+i+"个食物");        }    }}class Customer implements Runnable{    KeepSpace keepSpace;    public Customer(KeepSpace keepSpace) {        this.keepSpace = keepSpace;    }    @Override    public void run() {        //消费者消费        for (int i = 0; i &lt; 100; i++) {            System.out.println("消费了第"+keepSpace.pop().id+"个食物");        }    }}class KeepSpace{    //空间大小    Food[] foods = new Food[10];    //空间计数器    int count = 0;    public synchronized void push(Food food){        //空间满了，等待消费者消费        if (count==foods.length){            //通知消费者消费            try {                this.wait();            } catch (InterruptedException e) {                e.printStackTrace();            }        }        //空间没有满，继续制作        foods[count] = food;        count++;        //有吃的，可以通知消费者消费了        this.notifyAll();    }    //消费者消费    public synchronized Food pop(){        //判断能否消费        if (count==0){            //等待生产者生产            try {                this.wait();            } catch (InterruptedException e) {                e.printStackTrace();            }        }        count--;        Food food = foods[count];        //吃完了，通知生产者生产        this.notifyAll();        return food;    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2、信号灯法"><a href="#2、信号灯法" class="headerlink" title="2、信号灯法"></a>2、信号灯法</h3><p><strong>判断一个标志位flag，如果为true，就让他等待、如果为false，就让他去通知另外一个人、把两人衔接起来，就像咱们的信号灯红灯停，绿灯行，通过这样一个判断方式，只要来判断什么瑞后让他等待，什么时候将他唤醒</strong></p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 多线程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>引入base64编码的数据</title>
      <link href="2021/032918006.html"/>
      <url>2021/032918006.html</url>
      
        <content type="html"><![CDATA[<h2 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h2><p>Base64，顾名思义，就是包括小写字母a-z、大写字母A-Z、数字0-9、符号”+”、”/“一共64个字符的字符集，任何符号都可以转换成这个字符集中的字符，这个转换过程就叫做base64编码。</p><h3 id="编码和解码"><a href="#编码和解码" class="headerlink" title="编码和解码"></a>编码和解码</h3><p>Base64解码是将：字符串—&gt;二进制<br>Base64编码是将：二进制—&gt;字符串</p><p>图片/音频–&gt;二进制文件—&gt;base64编码为字符串—&gt;字符串被base64解码—&gt;二进制文件—&gt;图片/音频</p><h3 id="js进行编码和解码"><a href="#js进行编码和解码" class="headerlink" title="js进行编码和解码"></a>js进行编码和解码</h3><p>从IE10+浏览器开始，所有浏览器就原生提供了Base64编码、解码方法，不仅可以用于浏览器环境，Service Worker环境也可以使用。<br> 方法名就是 atob 和 btoa ，具体语法如下：</p><pre class="line-numbers language-dart" data-language="dart"><code class="language-dart">window.btoa('abcd') // 编码"YWJjZA=="window.atob("YWJjZA==")// 解码"abcd"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>当下，仍有不少PC项目还需要兼容IE9，所以，我们可以专门针对这些浏览器再引入一段ployfill脚本或者一个JS文件即可。</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!--[if IE]&gt;&lt;script src="https://www.zhangxinxu.com/wordpress/2018/08/js-base64-atob-btoa-encode-decode/base64-polyfill.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="audio标签"><a href="#audio标签" class="headerlink" title="audio标签"></a>audio标签</h2><p><strong>audio标签的src属性修改为data:audio/wav;base64,再加上base64字符串数据</strong></p><p>如：</p><pre class="line-numbers language-none"><code class="language-none">palyAudio(b64){this.audio = new Audio();this.audio.src = 'data:audio/wav;base64,'+b64;this.audio.play();},<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在上面的Data URI中，data表示取得数据的协定名称，audio/wav是数据类型名称，base64 是数据的编码方法，逗号后面就是这个audio/wav文件base64编码后的数据。</p><h2 id="其他类型用法"><a href="#其他类型用法" class="headerlink" title="其他类型用法"></a>其他类型用法</h2><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin">data:,文本数据data:text/plain,文本数据data:text/html,HTML代码data:text/html;base64,base64编码的HTML代码data:text/css,CSS代码data:text/css;base64,base64编码的CSS代码data:text/javascript,Javascript代码data:text/javascript;base64,base64编码的Javascript代码data:image/gif;base64,base64编码的gif图片数据data:image/png;base64,base64编码的png图片数据data:image/jpeg;base64,base64编码的jpeg图片数据data:image/x-icon;base64,base64编码的icon图片数据<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>但这种用法不兼容IE6/7</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>引入base64就是我们把文件的内容直接写在了HTML 文件中，这样做的好处是，节省了一个HTTP 请求。坏处呢，就是浏览器不会缓存这种图像。</p>]]></content>
      
      
      <categories>
          
          <category> H5 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> base64 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>axios封装</title>
      <link href="2021/032418001.html"/>
      <url>2021/032418001.html</url>
      
        <content type="html"><![CDATA[<h2 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h2><p>Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中。</p><ol><li><p><code>get(url[, config])</code>和<code>post(url[, data[, config]])</code>，注意参数</p><p><code>get在config中设置params</code>{params:{…} }`</p><p>或url中带入参数</p><pre class="line-numbers language-none"><code class="language-none">axios.get('/user?ID=12345')<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>post第二个参数是data</p><p>或使用axios(config)</p><p>config中<code>url</code> 是必需的。如果没有指定 <code>method</code>，请求将默认使用 <code>get</code> 方法。</p></li><li><p>headers中的<code>Content-Type</code>，视乎请求方式(GET/POST等)的不同，有不同默认值和处理方式</p></li><li><p>post方式中<code>data</code> 是作为请求主体被发送的数据只适用于这些请求方法 ‘PUT’, ‘POST’, 和 ‘PATCH’在没有设置 <code>transformRequest</code> 时，必须是以下类型之一：</p><p>​       string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams</p><ul><li>浏览器专属：FormData, File, Blob<br>Node 专属： Stream</li></ul><p>content-type默认情况下将被正确设置。其他不合情景的类型由JSON.stringify()处理为字符串，且content-type为<code>application/json</code>。手动设置content-type并不影响这个处理逻辑。</p><p>对于data是一个普通对象，想以<code>application/x-www-form-urlencoded</code>正确post传输(即html表单的post提交方式)<br> 简易解决方法：<br> (1)<code>axios.post('/api/login', 'a=1&amp;b=2' )</code> 我们自己直接写成符合的字符串<br> (2)使用<code>URLSearchParams</code>或者qs库进行处理，没啥好办法了。</p></li><li><p>get方式中</p><p>params` 是即将与请求一起发送的 URL 参数<br>必须是一个无格式对象(plain object)或 URLSearchParams 对象</p><p>执行多个并发请求时</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getUserAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user/12345'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">getUserPermissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user/12345/permissions'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>axios<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">getUserAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getUserPermissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>axios<span class="token punctuation">.</span><span class="token function">spread</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">acct<span class="token punctuation">,</span> perms</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// 两个请求现在都执行完成</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h3 id="全局的-axios-默认值"><a href="#全局的-axios-默认值" class="headerlink" title="全局的 axios 默认值"></a>全局的 axios 默认值</h3><pre class="line-numbers language-none"><code class="language-none">axios.defaults.baseURL = 'https://api.example.com';axios.defaults.headers.common['Authorization'] = AUTH_TOKEN;axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="自定义实例默认值"><a href="#自定义实例默认值" class="headerlink" title="自定义实例默认值"></a>自定义实例默认值</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 创建一个axios实例</span><span class="token keyword">const</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  baseURL<span class="token operator">:</span> <span class="token string">'https://api.example.com'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 设置实例</span>instance<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>common<span class="token punctuation">[</span><span class="token string">'Authorization'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">AUTH_TOKEN</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="配置的优先顺序"><a href="#配置的优先顺序" class="headerlink" title="配置的优先顺序"></a>配置的优先顺序</h3><p>配置会以一个优先顺序进行合并。这个顺序是：在 <code>lib/defaults.js</code> 找到的库的默认值，然后是实例的 <code>defaults</code> 属性，最后是请求的 <code>config</code> 参数。后者将优先于前者。这里是一个例子：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 使用由库提供的配置的默认值来创建实例</span><span class="token comment">// 此时超时配置的默认值是 `0`</span><span class="token keyword">var</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 覆写库的超时默认值</span><span class="token comment">// 现在，在超时前，所有请求都会等待 2.5 秒</span>instance<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">2500</span><span class="token punctuation">;</span><span class="token comment">// 为已知需要花费很长时间的请求覆写超时设置 在超时前，该请求都会等待 5 秒</span>instance<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/longRequest'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  timeout<span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h3><p>在请求或响应被 <code>then</code> 或 <code>catch</code> 处理前拦截它们。</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 添加请求拦截器</span>axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// 在发送请求之前做些什么</span>    <span class="token keyword">return</span> config<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// 对请求错误做些什么</span>    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 添加响应拦截器</span>axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// 对响应数据做点什么</span>    <span class="token keyword">return</span> response<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// 对响应错误做点什么</span>    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果你想在稍后移除拦截器，可以这样：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> myInterceptor <span class="token operator">=</span> axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">eject</span><span class="token punctuation">(</span>myInterceptor<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>可以为自定义 axios 实例添加拦截器</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="axios封装成插件，Vue进行安装"><a href="#axios封装成插件，Vue进行安装" class="headerlink" title="axios封装成插件，Vue进行安装"></a>axios封装成插件，Vue进行安装</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>  timeout<span class="token operator">:</span><span class="token number">8000</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">const</span> _axios <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//请求拦截器</span>_axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    loading<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//打开加载窗口</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 判断是否存在token，如果存在的话，则每个http header都加上token</span>      config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>Authorization <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">token </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> config<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 响应拦截器</span>_axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    loading<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//关闭加载窗口</span>    <span class="token keyword">return</span> response<span class="token punctuation">;</span>Plugin<span class="token punctuation">.</span><span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  Vue<span class="token punctuation">.</span>axios <span class="token operator">=</span> _axios<span class="token punctuation">;</span>  window<span class="token punctuation">.</span>axios <span class="token operator">=</span> _axios<span class="token punctuation">;</span>  Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span>    axios<span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> _axios<span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    $axios<span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> _axios<span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//定义插件</span>Plugin<span class="token punctuation">.</span><span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  Vue<span class="token punctuation">.</span>axios <span class="token operator">=</span> _axios<span class="token punctuation">;</span>  window<span class="token punctuation">.</span>axios <span class="token operator">=</span> _axios<span class="token punctuation">;</span>  Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span>    axios<span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> _axios<span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    $axios<span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> _axios<span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//插件安装</span>Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Plugin<span class="token punctuation">)</span><span class="token keyword">export</span> <span class="token keyword">default</span> Plugin<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> axios </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据交互 </tag>
            
            <tag> ajax </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ejs模板引擎</title>
      <link href="2021/032016108.html"/>
      <url>2021/032016108.html</url>
      
        <content type="html"><![CDATA[<h2 id="ejs"><a href="#ejs" class="headerlink" title="ejs"></a>ejs</h2><p>EJS 是一套简单的模板语言，帮你利用普通的 JavaScript 代码生成 HTML 页面。EJS 没有如何组织内容的教条；也没有再造一套迭代和控制流语法；有的只是普通的 JavaScript 代码而已。如 <strong>html = template + data</strong></p><h3 id="ejs使用"><a href="#ejs使用" class="headerlink" title="ejs使用"></a>ejs使用</h3><p> 首先NPM 安装 EJS 。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm install ejs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将模板字符串和一些数据作为参数传递给 EJS，Duang一下，HTML 出来了。</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//js代码</span><span class="token keyword">const</span> ejs<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ejs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//引入ejs</span>ejs<span class="token punctuation">.</span><span class="token function">renderFile</span><span class="token punctuation">(</span><span class="token string">'1.ejs'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'aaa'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'编译失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ejs代码</p><pre class="line-numbers language-ejs" data-language="ejs"><code class="language-ejs">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset="utf-8"&gt;    &lt;title&gt;&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    我的名字叫:&lt;% = name %&gt;&lt;/body&gt;&lt;/html&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>我们执行上述代码就会发现aaa已经被输出在body中</p><h4 id="在ejs中解析复杂对象"><a href="#在ejs中解析复杂对象" class="headerlink" title="在ejs中解析复杂对象"></a>在ejs中解析复杂对象</h4><p>js代码如下:</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> ejs<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ejs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ejs<span class="token punctuation">.</span><span class="token function">renderFile</span><span class="token punctuation">(</span><span class="token string">'2.ejs'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>json<span class="token operator">:</span><span class="token punctuation">{</span>arr<span class="token operator">:</span><span class="token punctuation">[</span>   <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'aaa'</span><span class="token punctuation">,</span>pass<span class="token operator">:</span><span class="token string">'123'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>   <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'blue'</span><span class="token punctuation">,</span>pass<span class="token operator">:</span><span class="token string">'456'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>   <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'jack'</span><span class="token punctuation">,</span>pass<span class="token operator">:</span><span class="token string">'789'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'编译失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ejs代码：</p><pre class="line-numbers language-ejs" data-language="ejs"><code class="language-ejs">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset="utf-8"&gt;    &lt;title&gt;&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;div&gt;        &lt;%=json.arr[0].name%&gt;    &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>执行以上代码我们会看到aaa已经被输出在div中</p><h4 id="在ejs中循环复杂对象中的数据"><a href="#在ejs中循环复杂对象中的数据" class="headerlink" title="在ejs中循环复杂对象中的数据"></a>在ejs中循环复杂对象中的数据</h4><p>js代码如下</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> ejs<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ejs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ejs<span class="token punctuation">.</span><span class="token function">renderFile</span><span class="token punctuation">(</span><span class="token string">'3.ejs'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>json<span class="token operator">:</span><span class="token punctuation">{</span>arr<span class="token operator">:</span><span class="token punctuation">[</span>    <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'amy'</span><span class="token punctuation">,</span>pass<span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'jack'</span><span class="token punctuation">,</span>pass<span class="token operator">:</span><span class="token number">456</span><span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'blue'</span><span class="token punctuation">,</span>pass<span class="token operator">:</span><span class="token number">789</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ejs代码：</p><pre class="line-numbers language-ejs" data-language="ejs"><code class="language-ejs">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset="utf-8"&gt;    &lt;title&gt;&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;% for(var i=0;i&lt;json.arr.length;i++){%&gt;    &lt;div&gt;        用户名:&lt;%=json.arr[i].name%&gt;        密码:&lt;%=json.arr[i].pass%&gt;    &lt;/div&gt;    &lt;% } %&gt;&lt;/body&gt;&lt;/html&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="标签含义"><a href="#标签含义" class="headerlink" title="标签含义"></a>标签含义</h3><ul><li><code>&lt;%</code> ‘脚本’ 标签，用于流程控制，无输出。</li><li><code>&lt;%_</code> 删除其前面的空格符</li><li><code>&lt;%=</code> 输出数据到模板（输出是转义 HTML 标签）</li><li><code>&lt;%-</code> 输出非转义的数据到模板</li><li><code>&lt;%#</code> 注释标签，不执行、不输出内容</li><li><code>&lt;%%</code> 输出字符串 ‘&lt;%’</li><li><code>%&gt;</code> 一般结束标签</li><li><code>-%&gt;</code> 删除紧随其后的换行符</li><li><code>_%&gt;</code> 将结束标签后面的空格符删除</li></ul><h3 id="包含（include）"><a href="#包含（include）" class="headerlink" title="包含（include）"></a>包含（include）</h3><p>通过 <code>include</code> 指令将相对于模板路径中的模板片段包含进来。(需要提供 ‘filename’ 参数。) 例如，如果存在 “./views/users.ejs” 和 “./views/user/show.ejs” 两个模板文件，你可以通过 <code>&lt;%- include('user/show'); %&gt;</code> 代码包含后者。</p><p>你可能需要能够输出原始内容的标签 (<code>&lt;%-</code>) 用于 include 指令，避免对输出的 HTML 代码做转义处理。</p><pre class="line-numbers language-ejs" data-language="ejs"><code class="language-ejs">&lt;ul&gt;  &lt;% users.forEach(function(user){ %&gt;    &lt;%- include('user/show', {user: user}); %&gt;  &lt;% }); %&gt;&lt;/ul&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="自定义分隔符"><a href="#自定义分隔符" class="headerlink" title="自定义分隔符"></a>自定义分隔符</h3><p>可针对单个模板或全局使用自定义分隔符：</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> ejs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ejs'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'geddy'</span><span class="token punctuation">,</span> <span class="token string">'neil'</span><span class="token punctuation">,</span> <span class="token string">'alex'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 单个模板文件</span>ejs<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'&lt;?= users.join(" | "); ?&gt;'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>users<span class="token operator">:</span> users<span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">{</span>delimiter<span class="token operator">:</span> <span class="token string">'?'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// =&gt; 'geddy | neil | alex'</span><span class="token comment">// 全局</span>ejs<span class="token punctuation">.</span>delimiter <span class="token operator">=</span> <span class="token string">'$'</span><span class="token punctuation">;</span>ejs<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'&lt;$= users.join(" | "); $&gt;'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>users<span class="token operator">:</span> users<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// =&gt; 'geddy | neil | alex'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ejs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 模板语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java static关键字</title>
      <link href="2021/031518004.html"/>
      <url>2021/031518004.html</url>
      
        <content type="html"><![CDATA[<h2 id="static修饰属性"><a href="#static修饰属性" class="headerlink" title="static修饰属性"></a>static修饰属性</h2><p>java中的<code>static</code>关键字主要用于内存管理。我们可以应用java <code>static</code>关键字在变量，方法，块和嵌套类中。 <code>static</code>关键字属于类，而不是类的实例。静态(<code>static</code>)可以修饰：</p><ol><li>变量（略</li><li>方法（略</li><li>代码块</li><li>嵌套类</li><li>静态导入</li></ol><h2 id="静态代码块"><a href="#静态代码块" class="headerlink" title="静态代码块"></a>静态代码块</h2><p>Java中的静态块主要有两个作用：</p><ul><li>用于初始化静态数据成员。</li><li>它在类加载时在main方法之前执行。（类只加载一次，静态代码块就只执行一次）</li></ul><h2 id="静态嵌套-内部-类"><a href="#静态嵌套-内部-类" class="headerlink" title="静态嵌套(内部)类"></a>静态嵌套(内部)类</h2><p>如果一个类要被声明为static的，只有一种情况，就是静态内部类。如果在外部类声明为static，程序会编译都不会过。在一番调查后个人总结出了3点关于内部类和静态内部类（俗称：内嵌类）</p><ol><li>静态内部类跟静态方法一样，只能访问静态的成员变量和方法，不能访问非静态的方法和属性，但是普通内部类可以访问任意外部类的成员变量和方法</li><li>静态内部类可以声明普通和静态成员变量和方法，而普通内部类不能声明static成员变量和方法。</li><li>静态内部类可以单独初始化: </li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java">Inner i = new Outer.Inner();<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> 普通内部类初始化：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">Outer o = new Outer();Inner i = o.new Inner();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h3><p> 静态内部类使用场景一般是<strong>当外部类需要使用内部类，而内部类无需外部类资源，并且内部类可以单独创建的时候</strong>会考虑采用静态内部类的设计，要知道如何初始化静态内部类，和如何使用静态内部类：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">public class Outer {    private String name;    private int age;public static class Builder {    private String name;    private int age;    public Builder(int age) {        this.age = age;    }    public Builder withName(String name) {        this.name = name;        return this;    }    public Builder withAge(int age) {        this.age = age;        return this;    }    public Outer build() {        return new Outer(this);    }}private Outer(Builder b) {    this.age = b.age;    this.name = b.name;}}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>静态内部类调用外部类的构造函数，来构造外部类，由于静态内部类可以被单独初始化说有在外部就有以下实现：</p><pre class="line-numbers language-none"><code class="language-none">public Outer getOuter(){    Outer outer = new Outer.Builder(2).withName("Yang Liu").build();    return outer;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="静态导入"><a href="#静态导入" class="headerlink" title="静态导入"></a>静态导入</h2><p>要使用静态成员（方法和变量）我们必须给出提供这个静态成员的类。使用<strong>静态导入</strong>可以使被导入类的<strong>静态变量</strong>和<strong>静态方法</strong>在当前类<strong>直接可见</strong>，使用这些静态成员无需再给出他们的类名。静态导入也是JDK5.0引入的新特性。</p><p>静态导入的语法是：</p><p>　　<strong>import static 包名.类名.静态成员变量;</strong></p><p>　　<strong>import static 包名.类名.静态成员函数;</strong></p><p>　　注意导入的是成员变量和方法名。</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue事件修饰符</title>
      <link href="2021/031118005.html"/>
      <url>2021/031118005.html</url>
      
        <content type="html"><![CDATA[<h2 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h2><p> 如果需要在内联语句处理器中访问原生DOM事件。可以使用特殊变量<code>$event</code>，把它传入到<code>methods</code>中的方法中。</p><p>   在vue中，事件修饰符处理了许多DOM事件的细节，让我们不再需要花大量的时间去处理这些烦恼的事情，而能有更多的精力专注于程序的逻辑处理。在Vue中事件修饰符主要有：</p><ul><li>**<code>.stop</code>**：等同于JavaScript中的<code>event.stopPropagation()</code>，防止事件冒泡</li><li>**<code>.prevent</code>**：等同于JavaScript中的<code>event.preventDefault()</code>，防止执行预设的行为（如果事件可取消，则取消该事件，而不停止事件的进一步传播）</li><li>**<code>.capture</code>**：与事件冒泡的方向相反，事件捕获由外到内</li><li>**<code>.self</code>**：只会触发自己范围内的事件，不包含子元素</li><li>**<code>.once</code>**：只会触发一次 </li></ul><h2 id="按键修饰符"><a href="#按键修饰符" class="headerlink" title="按键修饰符"></a>按键修饰符</h2><p>在监听键盘事件时，我们经常需要检查详细的按键。Vue 允许为 <code>v-on</code> 在监听键盘事件时添加按键修饰符：</p><p>使用 <code>keyCode</code> attribute 也是允许的：</p><pre class="line-numbers language-none"><code class="language-none">&lt;input v-on:keyup.13="submit"&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>为了在必要的情况下支持旧浏览器，Vue 提供了绝大多数常用的按键码的别名：</p><ul><li><code>.enter</code></li><li><code>.tab</code></li><li><code>.delete</code> (捕获“删除”和“退格”键)</li><li><code>.esc</code></li><li><code>.space</code></li><li><code>.up</code></li><li><code>.down</code></li><li><code>.left</code></li><li><code>.right</code></li></ul><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- 只有在 `key` 是 `Enter` 时调用 `vm.submit()` --&gt; &lt;input v-on:keyup.enter="submit"&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>有一些按键 (<code>.esc</code> 以及所有的方向键) 在 IE9 中有不同的 <code>key</code> 值, 如果你想支持 IE9，这些内置的别名应该是首选。</p><p>你还可以通过全局 <code>config.keyCodes</code> 对象自定义按键修饰符别名：</p><pre class="line-numbers language-none"><code class="language-none">// 可以使用 `v-on:keyup.f1`Vue.config.keyCodes.f1 = 112<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="鼠标修饰符"><a href="#鼠标修饰符" class="headerlink" title="鼠标修饰符"></a>鼠标修饰符</h2><p>鼠标修饰符用来限制处理程序监听特定的滑鼠按键。常见的有：</p><ul><li>**<code>.left</code>**：鼠标左键</li><li>**<code>.middle</code>**：鼠标中间滚轮</li><li>**<code>.right</code>**：鼠标右键</li></ul><h2 id="系统修饰键"><a href="#系统修饰键" class="headerlink" title="系统修饰键"></a>系统修饰键</h2><p>可以用如下修饰符开启鼠标或键盘事件监听，使在按键按下时发生响应：</p><ul><li><strong><code>.ctrl</code></strong></li><li><strong><code>.alt</code></strong></li><li><strong><code>.shift</code></strong></li><li><strong><code>.meta</code></strong></li></ul><p>注意：在 Mac 系统键盘上，meta 对应 command 键 (⌘)。在 Windows 系统键盘 meta 对应 Windows 徽标键 (⊞)。在 Sun 操作系统键盘上，meta 对应实心宝石键 (◆)。在其他特定键盘上，尤其在 MIT 和 Lisp 机器的键盘、以及其后继产品，比如 Knight 键盘、space-cadet 键盘，meta 被标记为“META”。在 Symbolics 键盘上，meta 被标记为“META”或者“Meta”。</p><p>例如：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- Alt + C --&gt;&lt;input v-on:keyup.alt.67="clear"&gt;&lt;!-- Ctrl + Click --&gt;&lt;div v-on:click.ctrl="doSomething"&gt;Do something&lt;/div&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>.exact</code> 修饰符允许你控制由精确的系统修饰符组合触发的事件。</p><pre class="line-numbers language-none"><code class="language-none">&lt;!-- 即使 Alt 或 Shift 被一同按下时也会触发 --&gt;&lt;button v-on:click.ctrl="onClick"&gt;A&lt;/button&gt;&lt;!-- 有且只有 Ctrl 被按下的时候才触发 --&gt;&lt;button v-on:click.ctrl.exact="onCtrlClick"&gt;A&lt;/button&gt;&lt;!-- 没有任何系统修饰符被按下的时候才触发 --&gt;&lt;button v-on:click.exact="onClick"&gt;A&lt;/button&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="自定义按键修饰符别名"><a href="#自定义按键修饰符别名" class="headerlink" title="自定义按键修饰符别名"></a>自定义按键修饰符别名</h2><p>在Vue中可以通过<code>config.keyCodes</code>自定义按键修饰符别名。例如，由于预先定义了<code>keycode 116</code>（即<code>F5</code>）的别名为<code>f5</code>，因此在文字输入框中按下<code>F5</code>，会触发<code>prompt</code>方法，出现<code>alert</code>。</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- HTML --&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-on:</span>keydown.f5</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prompt()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>Vue.config.keyCodes.f5 = 116;let app = new Vue({    el: '#app',    methods: {        prompt: function() {            alert('我是 F5！');        }    }});<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>你可能注意到这种事件监听的方式违背了关注点分离 (separation of concern) 这个长期以来的优良传统。但不必担心，因为所有的 Vue.js 事件处理方法和表达式都严格绑定在当前视图的 ViewModel 上，它不会导致任何维护上的困难。实际上，使用 <code>v-on</code> 有几个好处：</p><ol><li>扫一眼 HTML 模板便能轻松定位在 JavaScript 代码里对应的方法。</li><li>因为你无须在 JavaScript 里手动绑定事件，你的 ViewModel 代码可以是非常纯粹的逻辑，和 DOM 完全解耦，更易于测试。</li><li>当一个 ViewModel 被销毁时，所有的事件处理器都会自动被删除。你无须担心如何清理它们。</li></ol>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue,js录音功能实现</title>
      <link href="2021/031118006.html"/>
      <url>2021/031118006.html</url>
      
        <content type="html"><![CDATA[<h2 id="recorder-js"><a href="#recorder-js" class="headerlink" title="recorder.js"></a>recorder.js</h2><p>创建原生js，调用本地录音控件getUserMedia</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//recorder.js</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Recorder</span> <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">stream<span class="token punctuation">,</span> config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//兼容</span>        window<span class="token punctuation">.</span><span class="token constant">URL</span> <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span> <span class="token operator">||</span> window<span class="token punctuation">.</span>webkitURL<span class="token punctuation">;</span>        navigator<span class="token punctuation">.</span>getUserMedia <span class="token operator">=</span> navigator<span class="token punctuation">.</span>getUserMedia <span class="token operator">||</span> navigator<span class="token punctuation">.</span>webkitGetUserMedia        <span class="token operator">||</span> navigator<span class="token punctuation">.</span>mozGetUserMedia <span class="token operator">||</span> navigator<span class="token punctuation">.</span>msGetUserMedia<span class="token punctuation">;</span>        config <span class="token operator">=</span> config <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>        config<span class="token punctuation">.</span>sampleBits <span class="token operator">=</span> config<span class="token punctuation">.</span>sampleBits <span class="token operator">||</span> <span class="token number">16</span><span class="token punctuation">;</span>   <span class="token comment">//采样数位 8, 16</span>        config<span class="token punctuation">.</span>sampleRate <span class="token operator">=</span> config<span class="token punctuation">.</span>sampleRate <span class="token operator">||</span> <span class="token number">16000</span><span class="token punctuation">;</span> <span class="token comment">//采样率(1/6 44100)</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>webkitAudioContext <span class="token operator">||</span> window<span class="token punctuation">.</span>AudioContext<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>audioInput <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">createMediaStreamSource</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>createScript <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>createScriptProcessor <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>createJavaScriptNode<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>recorder <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createScript</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4096</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>audioData <span class="token operator">=</span> <span class="token punctuation">{</span>            size<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>          <span class="token comment">//录音文件长度</span>            buffer<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment">//录音缓存</span>            inputSampleRate<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>sampleRate<span class="token punctuation">,</span>   <span class="token comment">//输入采样率</span>            inputSampleBits<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>     <span class="token comment">//输入采样数位 8, 16</span>            outputSampleRate<span class="token operator">:</span> config<span class="token punctuation">.</span>sampleRate<span class="token punctuation">,</span>   <span class="token comment">//输出采样率</span>            oututSampleBits<span class="token operator">:</span> config<span class="token punctuation">.</span>sampleBits<span class="token punctuation">,</span>       <span class="token comment">//输出采样数位 8, 16</span>            <span class="token function-variable function">input</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>buffer<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>size <span class="token operator">+=</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token function-variable function">compress</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//合并压缩</span>                <span class="token comment">//合并</span>                <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>buffer<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    data<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>buffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>                    offset <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>buffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token comment">//压缩</span>                <span class="token keyword">let</span> compression <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>inputSampleRate <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>outputSampleRate<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> length <span class="token operator">=</span> data<span class="token punctuation">.</span>length <span class="token operator">/</span> compression<span class="token punctuation">;</span>                <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    result<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                    j <span class="token operator">+=</span> compression<span class="token punctuation">;</span>                    index<span class="token operator">++</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">return</span> result<span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token function-variable function">encodeWAV</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">let</span> sampleRate <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>inputSampleRate<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>outputSampleRate<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> sampleBits <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>inputSampleBits<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>oututSampleBits<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> bytes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> dataLength <span class="token operator">=</span> bytes<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token punctuation">(</span>sampleBits <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span><span class="token number">44</span> <span class="token operator">+</span> dataLength<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataView</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> channelCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//单声道</span>                <span class="token keyword">let</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> <span class="token function-variable function">writeString</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        data<span class="token punctuation">.</span><span class="token function">setUint8</span><span class="token punctuation">(</span>offset <span class="token operator">+</span> i<span class="token punctuation">,</span> str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span><span class="token punctuation">;</span>                <span class="token comment">// 资源交换文件标识符</span>                <span class="token function">writeString</span><span class="token punctuation">(</span><span class="token string">'RIFF'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>                <span class="token comment">// 下个地址开始到文件尾总字节数,即文件大小-8</span>                data<span class="token punctuation">.</span><span class="token function">setUint32</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> <span class="token number">36</span> <span class="token operator">+</span> dataLength<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>                <span class="token comment">// WAV文件标志</span>                <span class="token function">writeString</span><span class="token punctuation">(</span><span class="token string">'WAVE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>                <span class="token comment">// 波形格式标志</span>                <span class="token function">writeString</span><span class="token punctuation">(</span><span class="token string">'fmt '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>                <span class="token comment">// 过滤字节,一般为 0x10 = 16</span>                data<span class="token punctuation">.</span><span class="token function">setUint32</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>                <span class="token comment">// 格式类别 (PCM形式采样数据)</span>                data<span class="token punctuation">.</span><span class="token function">setUint16</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>                <span class="token comment">// 通道数</span>                data<span class="token punctuation">.</span><span class="token function">setUint16</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> channelCount<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>                <span class="token comment">// 采样率,每秒样本数,表示每个通道的播放速度</span>                data<span class="token punctuation">.</span><span class="token function">setUint32</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> sampleRate<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>                <span class="token comment">// 波形数据传输率 (每秒平均字节数) 单声道×每秒数据位数×每样本数据位/8</span>                data<span class="token punctuation">.</span><span class="token function">setUint32</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> channelCount <span class="token operator">*</span> sampleRate <span class="token operator">*</span> <span class="token punctuation">(</span>sampleBits <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>                <span class="token comment">// 快数据调整数 采样一次占用字节数 单声道×每样本的数据位数/8</span>                data<span class="token punctuation">.</span><span class="token function">setUint16</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> channelCount <span class="token operator">*</span> <span class="token punctuation">(</span>sampleBits <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>                <span class="token comment">// 每样本数据位数</span>                data<span class="token punctuation">.</span><span class="token function">setUint16</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> sampleBits<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>                <span class="token comment">// 数据标识符</span>                <span class="token function">writeString</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>                <span class="token comment">// 采样数据总数,即数据总大小-44</span>                data<span class="token punctuation">.</span><span class="token function">setUint32</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> dataLength<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                offset <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>                <span class="token comment">// 写入采样数据</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>sampleBits <span class="token operator">===</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> bytes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">,</span> offset<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token keyword">let</span> s <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">let</span> val <span class="token operator">=</span> s <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> s <span class="token operator">*</span> <span class="token number">0x8000</span> <span class="token operator">:</span> s <span class="token operator">*</span> <span class="token number">0x7FFF</span><span class="token punctuation">;</span>                        val <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token number">255</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">65535</span> <span class="token operator">/</span> <span class="token punctuation">(</span>val <span class="token operator">+</span> <span class="token number">32768</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        data<span class="token punctuation">.</span><span class="token function">setInt8</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> val<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> bytes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">,</span> offset <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token keyword">let</span> s <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        data<span class="token punctuation">.</span><span class="token function">setInt16</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> s <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> s <span class="token operator">*</span> <span class="token number">0x8000</span> <span class="token operator">:</span> s <span class="token operator">*</span> <span class="token number">0x7FFF</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'audio/wav'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">//开始录音</span>    <span class="token function">start</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>audioInput<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>recorder<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>recorder<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>destination<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//音频采集</span>        <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>recorder<span class="token punctuation">.</span><span class="token function-variable function">onaudioprocess</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            self<span class="token punctuation">.</span>audioData<span class="token punctuation">.</span><span class="token function">input</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>inputBuffer<span class="token punctuation">.</span><span class="token function">getChannelData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">//停止</span>    <span class="token function">stop</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>recorder<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">//获取音频文件</span>    <span class="token function">getBlob</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>audioData<span class="token punctuation">.</span><span class="token function">encodeWAV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">//回放</span>    <span class="token function">play</span> <span class="token punctuation">(</span><span class="token parameter">audio</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        audio<span class="token punctuation">.</span>src <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">//清理缓存的录音数据</span>    <span class="token function">clear</span> <span class="token punctuation">(</span><span class="token parameter">audio</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>audioData<span class="token punctuation">.</span>buffer <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>audioData<span class="token punctuation">.</span>size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        audio<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">''</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token function">checkError</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>        <span class="token keyword">let</span> errorMsg <span class="token operator">=</span> <span class="token string">''</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">case</span> <span class="token string">'AbortError'</span><span class="token operator">:</span> errorMsg <span class="token operator">=</span> <span class="token string">'录音设备无法被使用'</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">'NotAllowedError'</span><span class="token operator">:</span> errorMsg <span class="token operator">=</span> <span class="token string">'用户已禁止网页调用录音设备'</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">'PermissionDeniedError'</span><span class="token operator">:</span> errorMsg <span class="token operator">=</span> <span class="token string">'用户已禁止网页调用录音设备'</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>     <span class="token comment">// 用户拒绝</span>            <span class="token keyword">case</span> <span class="token string">'NotFoundError'</span><span class="token operator">:</span> errorMsg <span class="token operator">=</span> <span class="token string">'录音设备未找到'</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">'DevicesNotFoundError'</span><span class="token operator">:</span> errorMsg <span class="token operator">=</span> <span class="token string">'录音设备未找到'</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">'NotReadableError'</span><span class="token operator">:</span> errorMsg <span class="token operator">=</span> <span class="token string">'录音设备无法使用'</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">'NotSupportedError'</span><span class="token operator">:</span> errorMsg <span class="token operator">=</span> <span class="token string">'不支持录音功能'</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">'MandatoryUnsatisfiedError'</span><span class="token operator">:</span> errorMsg <span class="token operator">=</span> <span class="token string">'无法发现指定的硬件设备'</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">default</span><span class="token operator">:</span> errorMsg <span class="token operator">=</span> <span class="token string">'录音调用错误'</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> errorMsg <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token function">get</span> <span class="token punctuation">(</span>callback<span class="token punctuation">,</span> config<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>mediaDevices <span class="token operator">&amp;&amp;</span> navigator<span class="token punctuation">.</span>mediaDevices<span class="token punctuation">.</span>getUserMedia<span class="token punctuation">)</span> <span class="token punctuation">{</span>                navigator<span class="token punctuation">.</span>mediaDevices<span class="token punctuation">.</span><span class="token function">getUserMedia</span><span class="token punctuation">(</span><span class="token punctuation">{</span> audio<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> video<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">stream</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>                    <span class="token keyword">let</span> rec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Recorder</span><span class="token punctuation">(</span>stream<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token function">callback</span><span class="token punctuation">(</span>rec<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>                    <span class="token function">callback</span><span class="token punctuation">(</span>Recorder<span class="token punctuation">.</span><span class="token function">checkError</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                navigator<span class="token punctuation">.</span><span class="token function">getUserMedia</span><span class="token punctuation">(</span><span class="token punctuation">{</span> audio<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> video<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">stream</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>                    <span class="token keyword">let</span> rec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Recorder</span><span class="token punctuation">(</span>stream<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token function">callback</span><span class="token punctuation">(</span>rec<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>                    <span class="token comment">// Recorder.checkError(e)</span>                    <span class="token function">callback</span><span class="token punctuation">(</span>Recorder<span class="token punctuation">.</span><span class="token function">checkError</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="record-sdk-封装api"><a href="#record-sdk-封装api" class="headerlink" title="record-sdk(封装api)"></a>record-sdk(封装api)</h2><p>进行基本的功能封装</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> Recorder <span class="token keyword">from</span> <span class="token string">"./recorder"</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Record</span> <span class="token punctuation">{</span>    <span class="token function">startRecord</span> <span class="token punctuation">(</span><span class="token parameter">param</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            Recorder<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token parameter">rec</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>rec<span class="token punctuation">.</span>error<span class="token punctuation">)</span> <span class="token keyword">return</span> param<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>rec<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>                self<span class="token punctuation">.</span>recorder <span class="token operator">=</span> rec<span class="token punctuation">;</span>                self<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                param<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"开始录音"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            param<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"开始录音失败"</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token function">stopRecord</span> <span class="token punctuation">(</span><span class="token parameter">param</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token keyword">let</span> blobData <span class="token operator">=</span> self<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span><span class="token function">getBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            param<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>blobData<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            param<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"结束录音失败"</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token function">play</span> <span class="token punctuation">(</span><span class="token parameter">audio</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            self<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span>audio<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"录音播放失败"</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token function">clear</span> <span class="token punctuation">(</span><span class="token parameter">audio</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            self<span class="token punctuation">.</span>recorder<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>audio<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"清空录音失败"</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;template&gt;    &lt;div class="record"&gt;        &lt;h1&gt;{{tipMsg}}&lt;/h1&gt;        &lt;button @click="onStartVoice"&gt;开始&lt;/button&gt;        &lt;button @click="onEndVoice"&gt;结束&lt;/button&gt;        &lt;button @click="onPlayAudio"&gt;播放&lt;/button&gt;        &lt;div class="record-play"             v-show="isFinished"&gt;            &lt;h2&gt;Current voice player is:&lt;/h2&gt;            &lt;audio id="audioVoice"                   controls                   autoplay&gt;&lt;/audio&gt;        &lt;/div&gt;    &lt;/div&gt;&lt;/template&gt;&lt;script&gt;    import Record from '../plugins/record-sdk';//封装的api    export default {        name: 'voice',        data () {            return {                isVoice: false,                isFinished: false,                tipMsg: '语音',                audio: "",                recorder: new Record()            }        },        methods: {            // 开始录音            onStartVoice () {                this.tipMsg='正在录音'                this.onStopAudio()                this.isFinished = false;                this.recorder.startRecord({                    success: res =&gt; {                        this.isVoice = true                    },                    error: e =&gt; {                        this.isVoice = false                        this.$toast(e)                    }                });            },            // 结束录音            onEndVoice () {                this.tipMsg='录音结束'                this.isFinished = false;                this.recorder.stopRecord({                    success: res =&gt; {                        this.isVoice = false                        //此处可以获取音频源文件(res)，用于上传等操作                        console.log('音频源文件', res)                    },                    error: e =&gt; {                        this.isVoice = false                    }                });            },            // 播放录音            onPlayAudio () {                this.isVoice = false                this.isFinished = true;                this.audio = document.getElementById("audioVoice");                this.recorder.play(this.audio);            },            // 停止播放录音            onStopAudio () {                this.recorder.clear(this.audio);            }        }    }&lt;/script&gt;&lt;style scoped&gt;    .record{        display: flex;        flex-flow: row wrap;        justify-content: space-around;    }&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
          <category> js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 功能实现 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>H5+CSS3+ES6新特性总结</title>
      <link href="2021/030416107.html"/>
      <url>2021/030416107.html</url>
      
        <content type="html"><![CDATA[<h2 id="HTML5"><a href="#HTML5" class="headerlink" title="HTML5"></a>HTML5</h2><ol><li><p>语义化的区块和段落元素：<code>&lt;section&gt;</code>,<code>&lt;article&gt;</code>,<code>&lt;nav&gt;</code>,<code>&lt;header&gt;</code>,<code>&lt;footer&gt;</code>,<code>&lt;aside&gt;</code>和<code>&lt;hgroup&gt;</code> </p></li><li><p>音频和视频：<code>&lt;audio&gt;</code>和<code>&lt;video&gt;</code>元素嵌入和允许操作新的多媒体内容</p></li><li><p>表单input的属性：<code>color</code>，<code>date</code> ，<code>datetime-local</code> ，<code>email</code> </p></li><li><p>新的语义元素除了节段，媒体和表单元素之外，还有众多的新元素：<code>&lt;mark&gt;</code>，<code>&lt;figure&gt;</code>，<code>&lt;figcaption&gt;</code>，<code>&lt;data&gt;</code>，<code>&lt;time&gt;</code>，<code>&lt;output&gt;</code>，<code>&lt;progress&gt;</code>， 或者<code>&lt;meter&gt;</code>和<code>&lt;main&gt;</code>，这增加了有效的 HTML5 元素的数量。</p></li><li><p>MathML：允许直接嵌入数学公式。</p></li><li><p>Web Sockets：允许在页面和服务器之间建立持久连接并通过这种方法来交换非 HTML 数据。</p></li><li><p>Server-sent events：允许服务器向客户端推送事件，而不是仅在响应客户端请求时服务器才能发送数据的传统范式。</p></li><li><p>Web Workers：能够把 JavaScript 计算委托给后台线程，通过允许这些活动以防止使交互型事件变得缓慢。</p></li><li><p>XMLHttpRequest：允许异步读取页面的某些部分，允许其显示动态内容，根据时间和用户行为而有所不同。这是在<a href="https://link.zhihu.com/?target=https://developer.mozilla.org/zh-CN/docs/AJAX">Ajax</a>背后的技术。</p></li><li><p>History API：允许对浏览器历史记录进行操作。这对于那些交互地加载新信息的页面尤其有用。</p></li><li><p>SVG：一个基于 XML 的可以直接嵌入到 HTML 中的矢量图像格式。</p></li><li><p>Canvas：画布API。</p></li><li><p>Geolocation：地理API</p></li></ol><h3 id="增强型表单"><a href="#增强型表单" class="headerlink" title="增强型表单"></a>增强型表单</h3><p>1.新input type </p><pre class="line-numbers language-html" data-language="html"><code class="language-html">`<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>?</span><span class="token punctuation">&gt;</span></span>`**H4:text;checkbox;password;radio;submit;reset;File;`****H5:email;url;number;search;color;date;month;week**<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>2.新的表单元素</p><pre class="line-numbers language-none"><code class="language-none">**H4:input;button;select;textarea****H5:datalist;progress;meter;output**<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="datalist-数据列表"><a href="#datalist-数据列表" class="headerlink" title="datalist(数据列表)"></a>datalist(数据列表)</h4><p>datalist本身不可见，datalist为input提供输入建议列表</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>datalist</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”options”</span><span class="token punctuation">&gt;</span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Chrome<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Firefox<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Internet Explorer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Opera<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Safari<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>datalist</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">list</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>options<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="progress-进度条"><a href="#progress-进度条" class="headerlink" title="progress(进度条)"></a>progress(进度条)</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>progress</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>progress</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>progress</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0.5<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>progress</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><progress></progress> 左右晃动进度条<br><progress value="0.5"> </progress> 具有指定进度值进度条</p><h4 id="meter-刻度尺"><a href="#meter-刻度尺" class="headerlink" title="meter(刻度尺)"></a>meter(刻度尺)</h4><p>Meter：用于标示一个值所值的范围:不可接受(红色),可以接受(黄色),非常优秀(绿)<br>如薪水:</p><p>&lt;meter min=”最小值” max=”最大值” low=”下限” high=”上限” optimum=”最佳值” value=”当前值”&gt;</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meter</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>meter</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meter</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0.6<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>meter</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meter</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0.3<span class="token punctuation">"</span></span> <span class="token attr-name">high</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0.9<span class="token punctuation">"</span></span> <span class="token attr-name">low</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0.1<span class="token punctuation">"</span></span> <span class="token attr-name">optimum</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>meter</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><meter value="3" min="0" max="10">十分之三十分之三十分之三十分之三</meter>十分之三</p><p><meter value="0.6">60%</meter> 60%</p><p>**<meter value="0.3" high="0.9" low="0.1" optimum="2"></meter> **</p><h4 id="output"><a href="#output" class="headerlink" title="output"></a>output</h4><p>output:输出，语义标签,没有任何外观样式，样式等同于span</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">商品单价: 3.50购买数量: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>小计:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span>7.00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="表单元素新属性"><a href="#表单元素新属性" class="headerlink" title="表单元素新属性"></a>表单元素新属性</h4><p>H4:type;id;value;name;style;readyonly;disabled;checked<br>H5:<br>(1) placeholder 占位符<br>(2) autofocus 自动获取输入焦点<br>(3) multiple 允许输入框中输入多个值，用逗号分值<br>(4) form 用于把输入域放置在表单外部</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>f3<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">form</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>f3<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>(5) required 必填空<br>(6) maxlength 字符串最大长度<br>(7) minlength 字符串最小长度<br>(8) min 指定数值最小值<br>(9) max 指定数值最大值<br>(10) pattern 指定输入内容符合正则表达式</p><h3 id="视频与音频"><a href="#视频与音频" class="headerlink" title="视频与音频"></a>视频与音频</h3><h4 id="Flash被H5取代"><a href="#Flash被H5取代" class="headerlink" title="Flash被H5取代"></a>Flash被H5取代</h4><p> Flash绘图(AS/Flex)   -&gt;    canvas/svg<br> Flash动画            -&gt;    canvas/svg 定时器<br> Flash视频和音频播放   -&gt;    video/audio<br> Flash 客户端存储      -&gt;    webstorage</p><h4 id="视频播放"><a href="#视频播放" class="headerlink" title="视频播放"></a>视频播放</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”b.mp4”</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”b.mp4”</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”b.ogg”</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”b.webm”</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">&gt;</span></span>    您的浏览器版本太低，请升级  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>它本身是一个300*150的inline-block元素<br>成员属性:<br>autoplay 是否自动播放<br>controls 是否显示控件<br>muted 是否静音<br>loop 是否循环播放<br>poster 在播放第一帧画面之前广告(图片)<br>preload 视频加载策略</p><p><strong>auto: 预加载一定时长视频和元数据</strong></p><p>metadata:    仅预加载元素数(尺寸，时长，第一帧画面)<br>  none:        不加载任何内容</p><p><strong>对象属性:</strong></p><p>currentTime  当前播放时长<br>duration     总时长<br>paused:     当前视频是否处理暂停状态<br>volume（0~1）  音量</p><p>playbackRate: 回放速率: 大于1快播 小于1慢放<br>js 成员方法<br>play() 播放视频<br>pause() 暂停视频播放<br>js 事件<br>onplay 当视频开始播放触发事件<br>onpause 当视频暂停播放触发事件</p><h4 id="音频"><a href="#音频" class="headerlink" title="音频"></a>音频</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>audio</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”a.mp3”</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>audio</span><span class="token punctuation">&gt;</span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>audio</span><span class="token punctuation">&gt;</span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”a.mp3”</span> <span class="token punctuation">/&gt;</span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”a.wav”</span> <span class="token punctuation">/&gt;</span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>audio</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>它默认300*30的inline-block元素，但是没有controls属性，则display:none;<br>成员属性:<br>autoplay 是否自动播放<br>controls 是否显示控件<br>muted 是否静音<br>loop 是否循环播放<br>preload 视频加载策略</p><p><strong>auto: 预加载一定时长视频和元数据</strong></p><p>metadata:    仅预加载元素数(尺寸，时长，第一帧画面)<br>  none:        不加载任何内容</p><p><strong>对象属性</strong></p><p>currentTime  当前播放时长<br>duration     总时长<br>paused:     当前视频是否处理暂停状态<br>volume（0~1）  音量</p><p>playbackRate: 回放速率: 大于1快播 小于1慢放<br>js 成员方法<br>play() 播放视频<br>pause() 暂停视频播放<br>js 事件<br>onplay 当视频开始播放触发事件<br>onpause 当视频暂停播放触发事件</p><h3 id="canvas绘图"><a href="#canvas绘图" class="headerlink" title="canvas绘图"></a>canvas绘图</h3><p>应用: 网页中的实时走势图,抢红包,网页游戏,地图应用..<br>(1)SVG 绘图 2D矢量绘图技术，2000年出现,后纳入h5<br>(2)Canvas绘图 2D位图绘图技术，H5提出<br>(3)WebGL绘图 3D绘图技术，尚未纳入H5标准</p><p>Canvas绘图难点所在:<br>(1)坐标系<br>(2)单词比较多</p><h4 id="canvas"><a href="#canvas" class="headerlink" title="canvas"></a>canvas</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html">Canvas画布:画布是H5提供的绘图基础   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”500”</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”400”</span><span class="token punctuation">&gt;</span></span>      您的浏览器版本太低，请升级   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>Canvas标签在浏览器中默认是300*150的inine-block,画布宽度高度属性只能用js/属性来赋值.<br>不能用CSS样式赋值.<br>每个画布上有且只有一个”画笔”对象—使用该对象来绘图<br>var ctx = canvas.getContext(“2d”); 得到画布的画笔对象</p><p><strong>(1)使用canvas绘制矩形(长方形)</strong></p><p>矩形定位点在自己左上角<br> ctx.lineWidth = 1;        描边宽度(边线宽度)<br> ctx.fillStyle = “#999”;      填充样式<br> ctx.strokeStyle = “#000”;   描边样式<br> ctx.fillRect(x,y,w,h);       填充矩形<br> ctx.strokeRect(x,y,w,h);    描边矩形<br> ctx.clearRect(x,y,w,h);     清除矩形范围内所有图形</p><p><strong>(2)使用canvas绘制文本</strong></p><p>ctx.textBaseline = “alphabetic” 文本基线<br>ctx.font = “12px sans-serif”; 文本大小和字体<br>ctx.fillText(str,x,y); 填充一段文本<br>ctx.strokeText(str,x,y) 描边一段文本<br>ctx.measureText(str); 测量文本宽度</p><h4 id="路径"><a href="#路径" class="headerlink" title="路径"></a>路径</h4><p>path:由多个坐标点组成任意形状，路径不可见，可用于“描边”,</p><p>”填充”复杂图形依靠路径<br>ctx.beginPath(); 开始一条新路径<br>ctx.closePath(); 闭合当前路径<br>ctx.moveTo(x,y); 移动到指定点<br>ctx.lineTo(x,y); 从当前点到指定点画直线<br>ctx.arc(cx,cy,r,start,end); 绘制圆拱型 cx,cy 圆心 r 半径 start,end 开始角度和结束角度<br>圆弧度 0~2<em>Math.PI</em><br><em>角度=&gt;弧度 n</em>Math.PI/180=&gt;弧度<br>ctx.stroke(); 描边<br>ctx.fill(); 填充</p><h4 id="图像"><a href="#图像" class="headerlink" title="图像"></a>图像</h4><p>canvas 属于客户端技术，图片保存服务器，所以浏览器先下载，再绘制图片，且等待图处下载完成.</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> p3<span class="token punctuation">.</span>src <span class="token operator">=</span> “x<span class="token punctuation">.</span>jpg”<span class="token punctuation">;</span>     <span class="token comment">//下载指定图片</span>p3<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//当图片下载成功后触发事件</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p3<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>p3<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//绘制原始大小图片</span>ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>p3<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>w<span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//拉伸图片</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="图像-gt-变形"><a href="#图像-gt-变形" class="headerlink" title="图像->变形"></a>图像-&gt;变形</h4><p>canvas绘图中有变形技术同，可以针对某一个图形/图像在绘制过程中进行变形:rotate();translate();平移原点<br>ctx.rotate(弧度); 旋转绘制图像以画布原点为轴心.<br>ctx.translate(x,y); 将画布原点平移到指定位置<br>ctx.save(); 保存画笔当前所有状态值<br>ctx.restore()); 恢复画笔上一次保存时所有状态值</p><h3 id="svg绘制"><a href="#svg绘制" class="headerlink" title="svg绘制"></a>svg绘制</h3><p>位图:由一个一个像素点组成，每个点各有自己颜色，色彩细腻，但放大会失真.<br>矢量图:由一条一条线条组成，每个线条有自己颜色和方向，可以无限缩放，但细节不够丰富</p><p><strong>canvas绘图和svg绘图对比</strong></p><table><thead><tr><th></th><th>canvas</th><th>svg</th></tr></thead><tbody><tr><td>类型</td><td>2D位图</td><td>2D矢量图</td></tr><tr><td>如何绘制图</td><td>使用JS代码绘图</td><td>使用标签绘图</td></tr><tr><td>事件绑定</td><td>每个图形不是一个元素，无法直接绑定事件</td><td>每个图形都是元素，可以直接绑定事件监听</td></tr><tr><td>应用场合</td><td>游戏,特效</td><td>地图</td></tr></tbody></table><p>SVG诞生于2000年，早期作为XML扩展应用出现，H5标准把常用，SVG标签采纳为标准，但有些被废弃.<br><strong>svg使用方式</strong></p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><svg></svg> 本身是一个300*150的inline-block</p><h4 id="矩形"><a href="#矩形" class="headerlink" title="矩形"></a>矩形</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span><span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">storke-opacity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="圆形"><a href="#圆形" class="headerlink" title="圆形"></a>圆形</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="椭圆"><a href="#椭圆" class="headerlink" title="椭圆"></a>椭圆</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ecllipse</span>  <span class="token attr-name">rx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">ry</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span>  <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span>  <span class="token punctuation">/&gt;</span></span>  rx:水平半径  ry:垂直半径<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="直线"><a href="#直线" class="headerlink" title="直线"></a>直线</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””..</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>line</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="折线"><a href="#折线" class="headerlink" title="折线"></a>折线</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polyline</span> <span class="token attr-name">points</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”x,y</span> <span class="token attr-name">x,y</span> <span class="token attr-name">x,y</span> <span class="token attr-name">...”</span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>polyline</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">text-size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””</span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>””...</span><span class="token punctuation">&gt;</span></span>文本内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="图像-1"><a href="#图像-1" class="headerlink" title="图像"></a>图像</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”x.jpg”</span> <span class="token attr-name">x</span> <span class="token attr-name">y</span> <span class="token attr-name">width</span> <span class="token attr-name">height</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="渐变对象"><a href="#渐变对象" class="headerlink" title="渐变对象"></a>渐变对象</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">&gt;</span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”r2”</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”0%”</span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”0%”</span> <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”100%”</span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”0%”</span><span class="token punctuation">&gt;</span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”0%”</span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”green”</span><span class="token punctuation">&gt;</span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”50%”</span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”yellow”</span><span class="token punctuation">&gt;</span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”100%”</span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”red”</span><span class="token punctuation">&gt;</span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">&gt;</span></span>   &lt;rect width=”400” height=”200” fill=”url(#r2)”<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="地理定位-实现需要联网"><a href="#地理定位-实现需要联网" class="headerlink" title="地理定位(实现需要联网)"></a>地理定位(实现需要联网)</h3><p>Geolocation:地理定位,使用js获得当前浏览器所在地理坐标(经度，纬度，海拨，速度)数据，用于实现LBS应用(Location Base Service),如饿了么，高德导航…<br>获取地理定位类型<br>(1)浏览器自带对象geolocation[实现不了]<br>(2)百度地图,腾讯地图[准确度高]</p><p>手机浏览器如何获取定位信息<br>(1) 首选手机中GPS芯片与卫星通信，定位精度在米<br>(2) 次选手机通信基站进行定位，定位精度在公里<br>PC浏览器如何获取定位信息<br>(3) IP地理解析反向查找..</p><p>html5提供了一个新对象，用于获取当前浏览器定位信息<br>window.navigator.geolocation{};<br>getCurrentPosition:fn获取定位</p><p>百度地图:<br>(1)百度地图开发者 <a href="https://link.zhihu.com/?target=http://lbsyun.baidu.com/">http://lbsyun.baidu.com/</a><br>(2)注册百度开发者帐户 手机<br>(3)创建一个网站:为网站申请访问密钥 AccessKey</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">网站名称[abc123] [....]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>(4) AccessKey<br>(5)开放示例</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">//加载百度API指定密钥 &lt;script src="http://api.map.baidu.com/api? v=2.0&amp;ak=申请密钥"&gt; &lt;/script&gt; var map = new BMap.Map("container");<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>// 创建地图实例<br>var point = new BMap.Point(116.404, 39.915);<br>// 创建点坐标<br>map.centerAndZoom(point, 15);<br>// 初始化地图，设置中心点坐标和地图级别</p><h3 id="拖动API（拖动上传图片）"><a href="#拖动API（拖动上传图片）" class="headerlink" title="拖动API（拖动上传图片）"></a>拖动API（拖动上传图片）</h3><p>Drag &amp; Drop :拖动和释入<br>HTML5为拖动行为提供7个事件，分为两组<br>拖动的源动(会动)可以触发3个事件<br>dragstart 拖动开始<br>drag 拖动中<br>dragend 拖动结束<br>拖动的目标对象(不动)可以触发4个事件<br>dragenter 拖动进入<br>dragover 拖动悬停在上方<br>dragleave 拖动离开<br>drop 拖动释放</p><h3 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h3><p> 上传文件web项目通常使用功能:上传头像,邮件附件,上传商品图片,上传docx文档,喜玛拉雅，斗鱼…<br> 上传文件类型：指定任意类型/指定特定类型(jpg/png/gif)<br> 上传文件方式:<br> (1)表单同步提交  –简单,用户感受差<br> (2)ajax上传      –复杂,用户感受好(拖动,预览图片)<br> (3)第三方js工具库—剪切</p><h3 id="Web-Worker"><a href="#Web-Worker" class="headerlink" title="Web Worker"></a>Web Worker</h3><p>程序:一组代码(硬盘)<br>进程: 操作系统将程序代码调用(内存中)准备执行<br>线程: 进程内部执行代码序列</p><p>浏览器在线程模型:多个线程用于请求资源，运算js代码/渲染页面内容–1(UI)线程（并行加载，串行执行）</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>按钮1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>按钮2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>解决方案:<br>创建一个新的web Woker线程执行1.js程序,让UI继续执行绘制页面内容;</p><p><strong>1: Woker线程有缺点</strong><br>浏览器不允行worker线程操作DOM、BOM元素<br>原因:浏览器只允许UI线程操作DOM/BOM，也就是woker<br>执行的代码中不能包含DOM操作/类似jquery也不行.</p><p><strong>2:Worker线程可以发送或者接收UI线程数据</strong></p><p>//Woker发送数据–&gt;UI接收数据<br>   <strong>1:worker</strong><br>    postMessage(rs);<br>   <strong>2:UI</strong><br>    var w2 = new Worker(“01.js”);<br>    w2.onmessage = function(e){e.data}<br> //UI发送数据–&gt;Worker接收数据<br>   <strong>1:UI</strong><br>    var w2 = new Woker(“01.js”);<br>    w2.postMessage(stringMsg);<br>   <strong>2:Worker</strong><br>    onmessage = function(e){e.data}</p><p>项目中使用Worker<br>(1)只要js中有DOM/BOM不能使用Worker<br>(2)Worker适合于执行耗时JS任务,如数据分析数据统计</p><h3 id="WebStorage"><a href="#WebStorage" class="headerlink" title="WebStorage"></a>WebStorage</h3><p>在浏览器中存储当用户的专用数据: 访问历史;定制样式,<br> 在客户端存储数据技术<br> (1)Cookie技术        兼容性好,数据不能超4kb,操作复杂<br> (2)Flash                依赖Flash播放器<br> (3)H5 WebStorage        数据8MB左右,操作简单<br> (4)IndexedDB         可存储大量数据，不是标准</p><p><strong>Session:会话 (操作过程)</strong><br>浏览器从打开某一个网站第一个网页开始[会话开始],中间可能打开多个页面[会话中]直到关闭浏览器[会话结束],整个过程称为一次”会话”</p><p><strong>WebStorage提供二个对象:</strong></p><p>WebStorage提供两种类型的API：localStorage和sessionStorage，两者的区别看名字就有大概了解，localStorage在本地永久性存储数据，除非显式将其删除或清空，sessionStorage存储的数据只在会话期间有效，关闭浏览器则自动删除。两个对象都有共同的API</p><p><strong>(1)sessionStorage:类数组对象</strong><br>  在浏览器进程序中分配一内存,存储一次web会话数据,可供此次会话中所有页面读取或者保存，一旦浏览器关闭数据消失.<br>  示例:登录用户编号;昵称</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//保存数据</span>sessionStorage<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">=</span>val<span class="token punctuation">;</span>sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>sessionStorage<span class="token punctuation">.</span>length            <span class="token comment">//保存数量</span><span class="token keyword">var</span> key <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//依据数值返回左侧key</span><span class="token comment">//获取数据</span><span class="token keyword">var</span> val <span class="token operator">=</span> sessionStorage<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token keyword">var</span> val <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清除数据</span>sessionStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>sessionStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>(2)localStorage</strong><br> 数据保存磁盘上，数据可以跨会话，即使浏览器关闭，数据也保存。</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//保存数据</span>localStorage<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">=</span>val<span class="token punctuation">;</span>localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>localStorage<span class="token punctuation">.</span>length            <span class="token comment">//保存数量</span><span class="token keyword">var</span> key <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//依据数值返回左侧key</span><span class="token comment">//获取数据</span><span class="token keyword">var</span> val <span class="token operator">=</span> localStorage <span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token keyword">var</span> val <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清除数据</span>localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>localStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>注意点</strong></p><ol><li>localStorage中若数据发生了修改，会触发一次window.onstorage事件,可以监听此事件，实现监视localStorage数据改变目的,sessionStorage数据修改不会<br>触发此事件.</li><li>localStorage和sessionStorage只能存储字符串类型，对于复杂的对象可以使用ECMAScript提供的JSON对象的stringify和parse来处理</li></ol><h3 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h3><p>HTTP协议:属于”请求-响应”模型，只有客户端发起请求，服务器才会返回响应消息，没有请求就没有响应,一个请示主体，只能得到一个响应，有一些场景，此种模型力不从心如：实时股票走势图<br>解决方案: 长轮询(心跳请求)+AJAX –请求过于频繁，服务器压力大,不够频繁，客户不满意.</p><p>WebSocket协议: 属于”广播+接收”, 客户端连到服务器就不再断开,</p><p>永久连接,双方随时向对方发送数据,发送消息:ws协议适合于:实走股票走势图<br>ws服务器: 监听指定端口,向对方发送消息也可以接收消息.<br>ws客户端: 主动发起连接请求，保持永久连接，向对方发送消息，并且接收消息.</p><p>掌握:使用H5新特性创建ws客户端<br>(1)连接ws服务器</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">"ws://127.0.0.1:9001"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(2)向服务器发送消息</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>stringMsg<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(3)接收服务器返回消息</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">socket<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>e<span class="token punctuation">.</span>data<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(4)断开与服务器连接</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>小结端口:<br>apache 默认端口 80<br>mysql 默认端口 3306<br>https 默认端口 443<br>webSocket 默认端口 9001</p><h2 id="CSS3"><a href="#CSS3" class="headerlink" title="CSS3"></a><strong>CSS3</strong></h2><ol><li><p>阴影:使用<code>box-shadow</code>给逻辑框设置一个阴影，text-shadow文字加阴影</p></li><li><p>圆角：使用<code>border-image</code>和它关联的普通属性，而且可以通过<code>border-radius</code>属性来支持圆角边框</p></li><li><p>动画：为你的样式设置动画使用CSS Transitions以在不同的状态间设置动画，或者使用CSS Animations在页面的某些部分设置动画而不需要一个触发事件，你现在可以在页面中控制移动元素了</p></li><li><p>flex布局：css多栏布局</p></li><li><p>grid布局：网格布局</p></li><li><p>线性渐变：使用gradient设置线性渐变</p></li><li><p>媒体查询：根据显示设备的特性设置css</p></li><li><p>图片边框：使用border-image设置图片边框</p></li><li><p>em:与父元素的font-size的值有关</p></li><li><p>rem:与html的font-size的值有关</p></li><li><p>新增选择器 p:nth-child（n）{color: rgba（255, 0, 0, 0.75）}</p></li><li><p>弹性盒模型 display: flex;</p></li><li><p>多列布局 column-count: 5;</p></li><li><p>媒体查询 @media （max-width: 480px） {.box: {column-count: 1;}}</p></li><li><p>个性化字体 @font-face{font-family:BorderWeb;src:url（BORDERW0.eot）；}</p></li><li><p>颜色透明度 color: rgba（255, 0, 0, 0.75）；</p></li><li><p>圆角 border-radius: 5px;</p></li><li><p>渐变 background:linear-gradient（red, green, blue）；</p></li><li><p>阴影 box-shadow:3px 3px 3px rgba（0, 64, 128, 0.3）；</p></li><li><p>倒影 box-reflect: below 2px;</p></li><li><p>文字装饰 text-stroke-color: red;</p></li><li><p>文字溢出 text-overflow:ellipsis;</p></li><li><p>背景效果 background-size: 100px 100px;</p></li><li><p>边框效果 border-image:url（bt_blue.png） 0 10;</p></li><li><p>旋转 transform: rotate（20deg）；</p></li><li><p>倾斜 transform: skew（150deg, -10deg）；</p></li><li><p>位移 transform:translate（20px, 20px）；</p></li><li><p>缩放 transform: scale（。5）；</p></li><li><p>平滑过渡 transition: all .3s ease-in .1s; </p></li><li><p>动画 @keyframes anim-1 {50% {border-radius: 50%;}} animation: anim-1 1s;</p></li></ol><h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a><strong>ES6</strong></h2><ol><li><p>let和const关键字：let关键字定义块作用域变量，const定义常量</p></li><li><p>字符串模版：<code>${}</code></p></li><li><p>箭头函数：左边是参数集合，右边是函数体  <strong>箭头函数的this指向与普通函数不同  箭头函数在哪里定义 this就指向谁</strong></p></li><li><p>原生promise对象：将promise对象纳入规范</p></li><li><p>symbol：增加symbol数据类型</p></li><li><p>ES module: 引用ES module 模块化规范</p></li><li><p>… : 拓展运算符，用来代替argument对象</p></li><li><p>变量结构赋值</p></li><li><p>async函数</p></li><li><p>set和map函数</p></li><li><p>for..of循环：用来遍历实现迭代器接口的数据  任何部署了Iterator接口的对象，都可以用<code>for...of</code>循环遍历</p></li><li><p>class</p><p>…</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> web前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前端新特性 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
